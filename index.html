<!DOCTYPE html>
<html lang="en">
<head>x
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NLB8SZECVV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-NLB8SZECVV');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cory Ziller - Portfolio</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --space-1: 8px; --space-2: 16px; --space-3: 24px; --space-4: 32px;
            --space-5: 40px; --space-6: 48px; --space-8: 64px; --space-10: 80px;
            --space-12: 96px; --space-16: 128px;
            --text-xs: 0.75rem; --text-sm: 0.875rem; --text-base: 1rem;
            --text-lg: 1.125rem; --text-xl: 1.25rem; --text-2xl: 1.5rem;
            --text-3xl: 1.875rem; --text-4xl: 2.25rem; --text-5xl: 3rem;
            --bg-primary: #0a0a0a; --bg-secondary: #1a1a1a;
            --text-primary: #ffffff; --text-secondary: rgba(255, 255, 255, 0.85);
            --text-tertiary: rgba(255, 255, 255, 0.7);
            --border-subtle: rgba(255, 255, 255, 0.1);
            --spotify-green: #1DB954;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--text-base);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .hero {
            min-height: 100vh;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: var(--space-4);
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
        }

        .hero-content { max-width: 1100px; width: 100%; animation: fadeIn 0.8s ease-out; }
        .hero-grid { display: grid; grid-template-columns: 350px 1fr; gap: var(--space-8); align-items: start; margin-bottom: var(--space-4); }
        .hero-left { animation: slideUp 0.6s ease-out; }

        .profile-photo {
            width: 240px; height: 240px; border-radius: 16px;
            background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto var(--space-4); overflow: hidden;
            box-shadow: 0 8px 32px rgba(255, 255, 255, 0.15); transition: all 0.4s;
        }

        .profile-photo img { width: 100%; height: 100%; object-fit: cover; }
        .profile-photo:hover { transform: translateY(-4px); box-shadow: 0 12px 48px rgba(255, 255, 255, 0.2); }
        .hero-greeting { font-size: 1.125rem; font-weight: 500; color: var(--text-secondary); margin-bottom: var(--space-1); }
        .hero-name { font-size: 3.5rem; font-weight: 800; line-height: 1.05; letter-spacing: -0.03em; white-space: nowrap; }
        .hero-right { padding-left: var(--space-8); padding-top: var(--space-4); animation: slideUp 0.7s ease-out 0.1s both; }
        .credential-item { position: relative; margin-bottom: var(--space-4); padding-left: 28px; }
        .credential-bullet { position: absolute; left: 0; top: 8px; width: 10px; height: 10px; border-radius: 50%; background: var(--text-primary); box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); z-index: 2; }
        .credential-item:nth-child(2) .credential-bullet { opacity: 1; width: 10px; height: 10px; left: 0; }
        .credential-item:nth-child(3) .credential-bullet { opacity: 1; width: 10px; height: 10px; left: 0; }
        .credential-timeline-line { position: absolute; left: 4px; top: 18px; bottom: 20px; width: 0; border-left: 2px dotted rgba(255,255,255,0.15); z-index: 1; }
        .credential-label { font-size: var(--text-base); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-tertiary); margin-bottom: var(--space-1); }
        .credential-text { font-size: 1.25rem; font-weight: 700; color: var(--text-primary); line-height: 1.5; }
        .tagline-bridge { text-align: center; margin: var(--space-4) auto var(--space-2); padding: 0 var(--space-4); max-width: 800px; animation: fadeIn 0.8s ease-out 0.3s both; }
        .tagline-text { font-size: 1.25rem; font-weight: 500; font-style: italic; color: var(--text-secondary); line-height: 1.4; margin-bottom: var(--space-2); }
        .cta-container { display: flex; gap: var(--space-2); justify-content: center; align-items: flex-end; }
        .arrow-wrapper { display: flex; flex-direction: column; align-items: center; }
        .bouncing-arrow { font-size: var(--text-5xl); margin-bottom: var(--space-2); animation: bounce 2s ease-in-out infinite; color: var(--text-secondary); }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-16px); }
            60% { transform: translateY(-8px); }
        }

        .btn {
            display: inline-block; padding: 14px 32px; background: var(--text-primary);
            color: var(--bg-primary); text-decoration: none; border-radius: 100px;
            font-weight: 600; transition: all 0.3s; border: 2px solid transparent; cursor: pointer;
        }

        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(255, 255, 255, 0.15); }
        .btn-outline { background: transparent; color: var(--text-primary); border: 2px solid rgba(255, 255, 255, 0.3); }
        .btn-outline:hover { background: rgba(255, 255, 255, 0.05); }

        .works-section { padding: var(--space-6) var(--space-4); background: var(--bg-primary); overflow-x: hidden; }
        .works-container { max-width: 1280px; margin: 0 auto; overflow-x: hidden; }
        .works-header { text-align: center; margin-bottom: var(--space-3); }
        .works-header h2 { font-size: var(--text-5xl); margin-bottom: var(--space-3); font-weight: 800; }
        .works-subtitle { font-size: var(--text-lg); color: var(--text-secondary); max-width: 600px; margin: 0 auto; }
        .work-card { border-radius: 16px; cursor: pointer; }
        .work-card:not(.expanded) { transition: transform 0.3s, box-shadow 0.3s; }
        .work-card:not(.expanded):hover { transform: translateY(-8px); box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4); }
        .work-card.expanded { grid-column: 1 / -1; max-width: 900px; margin: 0 auto; z-index: 100; transform: none !important; transition: none !important; }
        .work-details { max-height: 0; overflow: hidden; transition: max-height 0.5s ease; }
        .work-card.expanded .work-details { max-height: 85vh; padding: var(--space-3); overflow-y: auto; }
        .scroll-section { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease, transform 0.8s ease; }
        .scroll-section.visible { opacity: 1; transform: translateY(0); }
        .close-btn { display: none; margin: var(--space-3) auto; padding: 12px 32px; background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(255, 255, 255, 0.2); color: white; border-radius: 100px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .work-card.expanded .close-btn { display: block; }
        .work-card.expanded .card-close-x { display: flex !important; }
        .card-close-x:hover { background: rgba(220, 50, 50, 0.7) !important; border-color: white !important; }
        .tiles-grid { display: grid !important; grid-template-columns: 1fr 1fr !important; gap: 20px !important; max-width: 900px !important; margin: 0 auto !important; width: 100% !important; box-sizing: border-box !important; }
        .quad-card { display: flex; flex-direction: column; justify-content: center; padding: 32px !important; box-sizing: border-box; overflow: hidden; }
        .quad-card:not(.expanded):hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }

        /* FULLSCREEN DASHBOARD */
        .fullscreen-modal {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: #000000; z-index: 9999; overflow-y: auto;
        }

        .fullscreen-modal.active { display: block; animation: fadeIn 0.3s ease; }

        .modal-close-btn {
            background: rgba(255, 255, 255, 0.15) !important;
            border: 2px solid rgba(255, 255, 255, 0.5) !important;
            position: fixed; top: 24px; right: 24px; width: 48px; height: 48px;
            background: rgba(255, 255, 255, 0.08); border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: 300;
            cursor: pointer; transition: all 0.3s; z-index: 10000;
            display: flex; align-items: center; justify-content: center;
        }

        .modal-close-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.4);
            transform: scale(1.1);
        }

        .dashboard-container { max-width: 1800px; margin: 0 auto; padding: var(--space-8) var(--space-4); }

        .dashboard-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: var(--space-6); padding-bottom: var(--space-4);
            border-bottom: 1px solid rgba(29, 185, 84, 0.3);
        }

        .dashboard-title { font-size: 2rem; font-weight: 900; color: #FFFFFF; }
        .dashboard-subtitle { font-size: 0.875rem; color: rgba(255, 255, 255, 0.6); text-transform: uppercase; letter-spacing: 0.1em; }

        /* TABS */
        .tab-navigation { display: flex; gap: var(--space-2); margin-bottom: var(--space-6); border-bottom: 1px solid rgba(255, 255, 255, 0.15); }

        .tab-btn {
            padding: 12px 24px; background: transparent; border: none;
            border-bottom: 3px solid transparent; color: rgba(255, 255, 255, 0.6);
            font-weight: 700; font-size: 0.9375rem; cursor: pointer; transition: all 0.2s;
            text-transform: uppercase; letter-spacing: 0.05em;
        }

        .tab-btn:hover { color: #FFFFFF; border-bottom-color: rgba(29, 185, 84, 0.5); }
        .tab-btn.active { color: var(--spotify-green); border-bottom-color: var(--spotify-green); }

        /* STATS CARDS */
        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-3); margin-bottom: var(--space-6);
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; padding: var(--space-4); transition: all 0.3s;
        }

        .stat-card:hover { background: rgba(255, 255, 255, 0.08); border-color: rgba(29, 185, 84, 0.5); transform: translateY(-2px); }
        .stat-value { font-size: 2.5rem; font-weight: 900; color: var(--spotify-green); margin-bottom: var(--space-1); line-height: 1; }
        .stat-label { font-size: 0.75rem; color: rgba(255, 255, 255, 0.7); text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700; }

        /* DATA TABLES */
        .data-table {
            background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; overflow: hidden; margin-bottom: var(--space-4);
            min-height: 600px; display: flex; flex-direction: column;
        }

        .table-header { background: rgba(29, 185, 84, 0.15); padding: var(--space-3); border-bottom: 1px solid rgba(29, 185, 84, 0.3); }
        .table-title { font-size: 1.125rem; font-weight: 800; color: #FFFFFF; }

        .table-row {
            display: grid; grid-template-columns: 50px 1fr 120px; gap: var(--space-3);
            padding: var(--space-3) var(--space-3); border-bottom: 1px solid rgba(255, 255, 255, 0.08); min-height: 97px;
            align-items: center; transition: all 0.2s;
        }

        .table-row:hover { background: rgba(29, 185, 84, 0.08); }
        .rank { font-weight: 900; color: var(--spotify-green); font-size: 1.125rem; }
        .item-info { flex: 1; }
        .item-name { font-weight: 700; color: #FFFFFF; margin-bottom: 2px; }
        .item-detail { font-size: 0.8125rem; color: rgba(255, 255, 255, 0.6); }
                .table-row:last-child { border-bottom: none; }
        .item-count { font-weight: 700; color: #FFFFFF; text-align: right; }

        /* YEAR SLIDER */
        .year-filter-container {
            background: rgba(255, 255, 255, 0.04); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; padding: var(--space-4); margin-bottom: var(--space-6);
        }

        .year-filter-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-3); }
        .year-filter-label { font-size: 0.875rem; font-weight: 700; color: rgba(255, 255, 255, 0.8); text-transform: uppercase; }
        .year-display { font-size: 1.5rem; font-weight: 900; color: var(--spotify-green); }

        .year-slider-wrapper { margin-top: var(--space-3); }

        .year-slider {
            width: 100%; height: 8px; border-radius: 4px;
            background: linear-gradient(to right, var(--spotify-green) 0%, rgba(29, 185, 84, 0.3) 100%);
            outline: none; -webkit-appearance: none; appearance: none;
        }

        .year-slider::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 24px; height: 24px; border-radius: 50%;
            background: var(--spotify-green); cursor: pointer;
            box-shadow: 0 2px 8px rgba(29, 185, 84, 0.5);
            border: 3px solid #000;
        }

        .year-slider::-moz-range-thumb {
            width: 24px; height: 24px; border-radius: 50%;
            background: var(--spotify-green); cursor: pointer; border: 3px solid #000;
            box-shadow: 0 2px 8px rgba(29, 185, 84, 0.5);
        }

        .year-marks {
            display: flex; justify-content: space-between; margin-top: var(--space-1);
            padding: 0 12px;
        }

        .year-mark {
            font-size: 0.75rem; color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
        }

        /* CHARTS */
        .chart-container {
            background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; padding: var(--space-4); margin-bottom: var(--space-4); height: 400px;
        }

        .chart-title { font-size: 1.125rem; font-weight: 800; color: #FFFFFF; margin-bottom: var(--space-3); }

        /* WORD CLOUD */
        .word-cloud-container {
            background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; padding: var(--space-6); min-height: 400px;
            display: flex; flex-wrap: wrap; align-items: center; justify-content: center;
            gap: var(--space-2);
        }

        /* EVOLUTION CAROUSEL */
        .evolution-controls {
            display: flex; justify-content: center; align-items: center; gap: var(--space-4);
            margin-bottom: var(--space-6); padding: var(--space-4);
            background: rgba(255, 255, 255, 0.04); border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
        }

        .evolution-btn {
            padding: 12px 20px; background: rgba(29, 185, 84, 0.15);
            border: 2px solid rgba(29, 185, 84, 0.3); color: var(--spotify-green);
            border-radius: 8px; cursor: pointer; font-weight: 700; transition: all 0.3s;
        }

        .evolution-btn:hover {
            background: rgba(29, 185, 84, 0.25);
            border-color: var(--spotify-green);
        }

        .evolution-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .evolution-year-display {
            font-size: 1.75rem; font-weight: 900; color: var(--spotify-green);
            min-width: 100px; text-align: center;
        }

        .evolution-panels {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-4);
            margin-bottom: var(--space-6);
        }

        .evolution-panels.two-panels {
            grid-template-columns: repeat(2, 1fr);
        }

        .evolution-panel {
            background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px; padding: var(--space-4); transition: all 0.3s;
        }

        .evolution-panel.current {
            background: rgba(29, 185, 84, 0.15);
            border-color: var(--spotify-green);
            box-shadow: 0 0 24px rgba(29, 185, 84, 0.3);
        }

        .evolution-panel-title {
            font-size: 1.25rem; font-weight: 800; color: var(--spotify-green);
            margin-bottom: var(--space-3); text-align: center;
        }

        .evolution-artist-row {
            display: grid; grid-template-columns: 40px 1fr 80px; gap: var(--space-2);
            padding: var(--space-2) 0; border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            align-items: center;
        }

        .evolution-artist-row:last-child {
            border-bottom: none;
        }

        .evolution-rank {
            font-weight: 900; color: var(--spotify-green); text-align: center;
        }

        .evolution-artist-name {
            font-weight: 600; color: #FFFFFF; font-size: 0.9375rem;
        }

        .evolution-change {
            font-size: 0.75rem; font-weight: 700; text-align: right;
        }

        .evolution-change.new {
            color: #1DB954;
        }

        .evolution-change.up {
            color: #1DB954;
        }

        .evolution-change.down {
            color: #ec4899;
        }

        .evolution-change.neutral {
            color: rgba(255, 255, 255, 0.5);
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(24px); } to { opacity: 1; transform: translateY(0); } }

        

        /* ===== MOBILE RESPONSIVE FIXES ===== */
        @keyframes rainbow-flash {
            0% { border-color: #ff0000; box-shadow: 0 0 8px #ff0000, 0 0 20px rgba(255,0,0,0.3); }
            14% { border-color: #ff8800; box-shadow: 0 0 8px #ff8800, 0 0 20px rgba(255,136,0,0.3); }
            28% { border-color: #ffff00; box-shadow: 0 0 8px #ffff00, 0 0 20px rgba(255,255,0,0.3); }
            42% { border-color: #00ff00; box-shadow: 0 0 8px #00ff00, 0 0 20px rgba(0,255,0,0.3); }
            57% { border-color: #0088ff; box-shadow: 0 0 8px #0088ff, 0 0 20px rgba(0,136,255,0.3); }
            71% { border-color: #8800ff; box-shadow: 0 0 8px #8800ff, 0 0 20px rgba(136,0,255,0.3); }
            85% { border-color: #ff00ff; box-shadow: 0 0 8px #ff00ff, 0 0 20px rgba(255,0,255,0.3); }
            100% { border-color: #ff0000; box-shadow: 0 0 8px #ff0000, 0 0 20px rgba(255,0,0,0.3); }
        }
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        @media (max-width: 768px) {
            /* Hero Section */
            .hero { padding: 0 var(--space-3) 0; min-height: 100dvh; display: flex; flex-direction: column; justify-content: center; }
            .hero-grid { grid-template-columns: 1fr !important; gap: 6px; text-align: center; }
            .hero-left { display: flex; flex-direction: column; align-items: center; gap: 0; }
            .hero-right { padding: 0 !important; margin-top: 0 !important; }
            .profile-photo { width: 80px; height: 80px; margin-bottom: 2px !important; }
            .hero-name { font-size: 1.5rem; margin-bottom: 0; margin-top: 0; }
            .hero-greeting { font-size: var(--text-sm); margin-bottom: 0; margin-top: 0; }
            .credential-bullet { display: none !important; }
            .credential-item { text-align: center; max-width: 100%; margin-bottom: 2px !important; padding: 4px 0 !important; }
            .credential-label { font-size: 0.6rem !important; margin-bottom: 0 !important; letter-spacing: 1px; }
            .credential-text { font-size: var(--text-sm); margin: 0 !important; }

            /* CTA Buttons - stacked, even 16px spacing */
            .cta-container { flex-direction: column !important; align-items: center !important; gap: 10px !important; margin-top: 8px !important; }
            .cta-container > a.btn,
            .cta-container .arrow-wrapper .btn { width: 100% !important; max-width: 260px; padding: 10px 18px !important; font-size: 0.85rem !important; text-align: center !important; display: block !important; box-sizing: border-box !important; }
            .arrow-wrapper { width: 100%; max-width: 280px; display: flex !important; flex-direction: column !important; align-items: center !important; gap: 0 !important; margin: 0 !important; padding: 0 !important; }
            .bouncing-arrow { display: none !important; }
            .arrow-wrapper .btn { border: 2px solid #ff0000 !important; border-radius: 12px !important; animation: rainbow-flash 1.5s linear infinite, flicker 0.8s ease-in-out infinite !important; }

            /* Scroll indicator after CTA buttons */
            .cta-container::after { content: 'Scroll down for more'; display: block; width: 100%; text-align: center; color: rgba(255,255,255,0.4); font-size: 0.75rem; margin-top: 8px; letter-spacing: 1px; }

            /* Projects - single column */
            .works-section { padding: var(--space-6) var(--space-3); }
            .works-container { padding: 0; }
            .works-header { padding: 0 var(--space-2); text-align: center; }
            .works-container > div[style*="grid"],
            div[style*="grid-template-columns"]:not(.evolution-panels):not(.evolution-artist-row):not(.tiles-grid) { grid-template-columns: 1fr !important; gap: 16px !important; }
            .tiles-grid { grid-template-columns: 1fr !important; gap: 16px !important; max-width: 100% !important; }
            .work-card { border-radius: 12px; overflow: hidden; box-sizing: border-box; max-width: 100%; }
            .quad-card { padding: var(--space-3); overflow: hidden; box-sizing: border-box; max-width: 100%; word-wrap: break-word; overflow-wrap: break-word; }
            .quad-title { font-size: 1.1rem !important; }

            /* Project detail popouts - single column */
            .work-details { width: 100% !important; max-width: 100% !important; overflow-x: hidden !important; }
            .work-details > div,
            .work-details div[style*="grid"] {
                grid-template-columns: 1fr !important;
                gap: 24px !important;
            }
            .work-details div[style*="grid"] > div:last-child {
                order: -1 !important;
            }
            .work-details div[style*="grid"] > div { width: 100% !important; max-width: 100% !important; margin-bottom: 16px; }
            .work-details div[style*="border-radius"],
            .work-details span[style*="border-radius"] { display: inline-block !important; margin: 4px !important; font-size: 0.8rem !important; }

            /* Fullscreen modal */
            .fullscreen-modal { overflow-y: auto !important; -webkit-overflow-scrolling: touch; padding: var(--space-2) !important; }
            .fullscreen-modal > div { max-width: 100% !important; padding: var(--space-3) !important; overflow-x: hidden !important; }

            /* Spotify Dashboard */
            .dashboard-container { padding: var(--space-3) var(--space-2); max-width: 100% !important; overflow-x: hidden !important; }
            .dashboard-header { flex-direction: column; gap: var(--space-3); align-items: flex-start; }
            .dashboard-title { font-size: 1.5rem; }
            .dashboard-subtitle { font-size: var(--text-sm); }
            .tab-navigation { display: flex !important; flex-wrap: wrap !important; gap: 6px !important; padding-bottom: 8px; justify-content: center; }
            .tab-btn { padding: 6px 10px; font-size: 0.6rem; white-space: nowrap; flex-shrink: 0; }

            /* Evolution panels - single column so artist names show fully */
            .evolution-panels { grid-template-columns: repeat(3, 1fr) !important; gap: 4px !important; margin-bottom: var(--space-2) !important; overflow-x: auto !important; max-width: 100% !important; }
            .evolution-panel { padding: 6px !important; min-width: 0 !important; overflow: hidden; }
            .evolution-panel-title { font-size: 0.7rem !important; margin-bottom: 4px !important; }
            .evolution-rank { font-size: 0.55rem !important; white-space: normal !important; overflow: visible !important; line-height: 1.3; padding: 1px 0 !important; word-break: break-word; }
            .evolution-artist-row { gap: 2px !important; padding: 2px 4px !important; }
            .evolution-controls { flex-wrap: wrap; gap: 6px !important; }
            .evolution-btn { min-height: 36px !important; min-width: 70px !important; font-size: 0.75rem !important; padding: 8px 12px !important; }
            .evolution-artist-name { font-size: 0.85rem !important; white-space: normal !important; overflow: visible !important; text-overflow: unset !important; }
            .evolution-change { font-size: 0.75rem !important; white-space: nowrap; }

            /* Word cloud - scale to fit mobile */
            .word-cloud-container {
                transform: scale(0.38) !important;
                transform-origin: top center !important;
                width: 100% !important;
                margin-bottom: -250px !important;
                overflow: visible !important;
            }

            .chart-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
            .chart-container canvas { min-width: 280px; }

            /* Timeline - hide gray center line on mobile */
            #history > div > div[style*="position: absolute"][style*="width: 2px"] { left: 8px !important; transform: translateX(-50%) !important; }

            /* Timeline - single column, dots as circles */
            .tl-item.tl-left, .tl-item.tl-right { flex-direction: column !important; align-items: flex-start !important; margin-bottom: var(--space-4) !important; padding-left: 30px !important; }
            .tl-item > div:not(.tl-dot) { width: 100% !important; padding-left: 0 !important; padding-right: 0 !important; text-align: left !important; }
            .tl-dot {
                width: 20px !important;
                height: 20px !important;
                min-width: 20px !important;
                min-height: 20px !important;
                left: 8px !important;
                transform: translateX(-50%) !important;
                z-index: 5 !important;
                border-radius: 50% !important;
                position: absolute !important;
            }
            .tl-left > div:nth-child(3) { display: none !important; }
            .tl-right > div:first-child { display: none !important; }
            .tl-item .tl-dot {
                width: 20px !important;
                height: 20px !important;
                min-width: 20px !important;
                min-height: 20px !important;
                border-radius: 50% !important;
                left: 8px !important;
                transform: translateX(-50%) !important;
            }
            .tl-card { padding: var(--space-3); width: 100% !important; box-sizing: border-box; background: #1a1a1a !important; position: relative; z-index: 1; }
            .tl-title { font-size: var(--text-base); }
            .tl-date { font-size: var(--text-xs); }
            .tl-desc { font-size: var(--text-sm); }

            .close-btn, .modal-close-btn, .card-close-x { font-size: 1.5rem; padding: var(--space-2); }
            h2, .section-title { font-size: 1.5rem !important; }
            .scroll-section { padding: var(--space-4) var(--space-3); }

            .work-card.expanded { position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; width: 100% !important; height: 100% !important; z-index: 1000 !important; overflow-y: auto !important; -webkit-overflow-scrolling: touch !important; padding: var(--space-3) !important; box-sizing: border-box !important; }
            .work-card.expanded .work-details { overflow-y: auto !important; max-height: none !important; }
        
            /* Make tabs show there are more options */
            .work-details div[style*="space-between"] {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 4px !important;
            }
            .evolution-btn {
                min-height: 52px !important;
                min-width: 110px !important;
                font-size: 16px !important;
                padding: 14px 22px !important;
                touch-action: manipulation !important;
            }
            .evolution-controls { gap: 12px !important; }
            .fullscreen-modal button, .fullscreen-modal .tab-btn {
                touch-action: manipulation !important;
            }

            /* === Spotify & Social Listening Card Detail Mobile Fixes === */
            .work-details { padding: var(--space-3) !important; }
            .work-details > div > div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 24px !important;
            }
            .work-details div[style*="flex-direction: column"][style*="gap: 16px"] {
                gap: 10px !important;
            }
            .work-details div[style*="space-between"] span {
                font-size: 0.7rem !important;
                padding: 2px 6px !important;
            }
            .work-details h3 { font-size: 1rem !important; }
            .work-details h4 { font-size: 0.85rem !important; }
            .work-details p { font-size: 0.85rem !important; line-height: 1.5 !important; }
            .work-details label { font-size: 0.7rem !important; }
            .scroll-section { max-height: none !important; overflow: visible !important; }
            .scroll-section img { width: 100% !important; height: auto !important; border-radius: 8px; }
            /* Step items - stack badge below text */
            .work-details div[style*="space-between"] > div:first-child {
                max-width: 100% !important;
            }
            /* Impact metrics grid */
            .work-details div[style*="grid"][style*="repeat"] {
                grid-template-columns: 1fr 1fr !important;
                gap: 12px !important;
            }
            /* Close button positioning for mobile */
            .work-details > button[style*="absolute"] {
                top: -60px !important;
                right: 10px !important;
            }
            /* Dashboard charts and tab content */
            .dashboard-container { padding: var(--space-2) !important; }
            .dashboard-header { flex-direction: column !important; gap: 8px !important; }
            .dashboard-title { font-size: 1.1rem !important; }
            .dashboard-subtitle { font-size: 0.75rem !important; }
            /* Card modal on mobile */
            .fullscreen-modal .quad-card { padding: var(--space-3) !important; }
        
            /* === Additional mobile centering & optimization === */
            .works-section { padding: var(--space-3) !important; }
            .works-section h2 { text-align: center !important; font-size: 1.3rem !important; }
            .work-card { margin-bottom: var(--space-3) !important; }
            .work-card h3 { font-size: 0.9rem !important; text-align: center !important; }
            .work-card p { font-size: 0.8rem !important; line-height: 1.5 !important; }
            /* Charts responsive */
            canvas { max-width: 100% !important; height: auto !important; }
            .chart-container, div[style*="chart"] { width: 100% !important; overflow: hidden !important; }
            /* Tab content area */
            .tab-content { padding: var(--space-2) !important; }
            /* Dashboard mobile optimization */
            .dashboard-header { text-align: center !important; }
            /* Word cloud */
            .word-cloud-container, div[id*="cloud"] { max-width: 100% !important; overflow: hidden !important; }
            /* Timeline line over fix */
            #history > div > div[style*="position: absolute"][style*="width: 2px"] { z-index: 1 !important; }

            /* === CONVERSIONS MODAL MOBILE === */
            #conversionsModal > div { padding: 20px 16px !important; }
            #conversionsModal h1 { font-size: 1.25rem !important; }
            #conversionsModal p { font-size: 0.85rem !important; }
            #conversionsReadme {
                grid-template-columns: 1fr !important;
                gap: 16px !important;
            }
            #conversionsReadme > div:last-child {
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                top: auto !important;
                transform: none !important;
                z-index: 100 !important;
            }
            #conversionsReadme > div:last-child > div {
                padding: 14px 16px !important;
                border-radius: 12px 12px 0 0 !important;
                max-height: 35vh !important;
                overflow-y: auto !important;
            }
            #readmeScroller {
                margin-bottom: 35vh !important;
            }
            #readmeScroller pre {
                font-size: 0.65rem !important;
                padding: 12px !important;
                line-height: 1.5 !important;
            }
            #guideTitle { font-size: 1.15rem !important; }
            #guideDesc { font-size: 0.95rem !important; }
            #guideExampleText { font-size: 0.85rem !important; }

            /* === SPOTIFY PIPELINE BOXES MOBILE === */
            .pipeline-flow {
                display: grid !important;
                grid-template-columns: 1fr auto 1fr auto 1fr !important;
                gap: 4px !important;
                align-items: center !important;
            }
            .pipeline-flow > div[style*="min-width: 80px"] {
                min-width: 0 !important;
                padding: 8px 4px !important;
            }
            .pipeline-flow > div[style*="min-width: 80px"] > div:first-child {
                font-size: 0.7rem !important;
            }
            .pipeline-flow > div[style*="min-width: 80px"] > div:nth-child(2) {
                font-size: 0.55rem !important;
            }
            .pipeline-flow > div[style*="min-width: 80px"] > div:nth-child(3) {
                font-size: 0.55rem !important;
            }
            /* Pipeline arrows smaller on mobile */
            .pipeline-flow > div[style*="padding: 0 4px"] {
                font-size: 0.7rem !important;
                padding: 0 1px !important;
            }

            /* === EXPANDED CARD HEADINGS MOBILE === */
            .work-details h4 { font-size: 1.2rem !important; }
            .work-details .scroll-section h3 { font-size: 1.3rem !important; }
            .work-details .scroll-section { padding: 20px 16px !important; }

            /* === WORK HISTORY SUBTITLE MOBILE === */
            #history > p { font-size: 0.9rem !important; }
        }
        @media (max-width: 480px) {
            .hero-name { font-size: 1.5rem; }
            .profile-photo { width: 120px; height: 120px; }
            .cta-container > a.btn,
            .cta-container .arrow-wrapper .btn { max-width: 260px; padding: 10px 16px !important; font-size: 0.85rem !important; }
            .arrow-wrapper { max-width: 260px; }
            .tab-btn { padding: 6px 10px; font-size: 0.65rem; }
            .dashboard-title { font-size: 1.25rem; }
            .credential-text { font-size: var(--text-sm); }
            h2, .section-title { font-size: 1.25rem !important; }
            .quad-card { padding: var(--space-2); }
            .quad-title { font-size: 1rem !important; }
            .word-cloud-container { transform: scale(0.55) !important; margin-bottom: -80px !important; }
            /* Pipeline: stack to 2 rows on very small screens */
            .pipeline-flow {
                grid-template-columns: 1fr auto 1fr !important;
                row-gap: 8px !important;
            }
            .pipeline-flow > div:nth-child(n+6) {
                grid-column: auto;
            }
            #readmeScroller pre { font-size: 0.58rem !important; }
            #conversionsModal h1 { font-size: 1.1rem !important; }
        }

        @media (max-width: 1024px) {
            .hero-grid { grid-template-columns: 1fr; gap: var(--space-8); text-align: center; }
            .hero-right { padding-left: 0; }
            .credential-item { text-align: left; max-width: 600px; margin-left: auto; margin-right: auto; }
            .evolution-panels { grid-template-columns: 1fr; }
        }

        html { scroll-behavior: smooth; }
    </style>
</head>
<body>
    <section class="hero">
        <div class="hero-content">
            <div class="hero-grid">
                <div class="hero-left">
                    <div class="profile-photo">
                        <img src="profile.jpg" alt="Cory Ziller" onerror="this.parentElement.innerHTML='CZ';">
                    </div>
                    <div style="text-align: left;">
                        <p class="hero-greeting">Hey there,</p>
                        <h1 class="hero-name">I'm Cory Ziller</h1>
                    </div>
                </div>

                <div class="hero-right" style="position: relative;">
                    <div class="credential-timeline-line"></div>
                    <div class="credential-item">
                        <div class="credential-bullet"></div>
                        <div class="credential-label">Current</div>
                        <p class="credential-text">STEM MBA candidate at Ohio State (Class of 2027).</p>
                    </div>

                    <div class="credential-item">
                        <div class="credential-bullet"></div>
                        <div class="credential-label">Previously</div>
                        <p class="credential-text">5+ years in marketing, data and analytics, and product thinking.</p>
                    </div>

                    <div class="credential-item">
                        <div class="credential-bullet"></div>
                        <div class="credential-label">Early Experience</div>
                        <p class="credential-text">AI startup experience supporting law enforcement adoption of anti-trafficking technology.</p>
                    </div>
                </div>
            </div>

            <div class="tagline-bridge">
                <p class="tagline-text">I love turning ideas into automation. Check it out!</p>

                <div class="cta-container">
                    <a href="https://www.linkedin.com/in/cory-ziller/" target="_blank" class="btn btn-outline">View LinkedIn</a>

                    <div class="arrow-wrapper">
                        <div class="bouncing-arrow">&#8595;</div>
                        <a href="#works" class="btn">Writing Samples & Side Projects</a>
                    </div>

                    <a href="#history" class="btn btn-outline">Work History</a>
                </div>
            </div>
        </div>
    </section>

    <section class="works-section" id="works">
        <div class="works-container">
            <div class="works-header">
                <h2>Writing Samples & Side Projects</h2>
                <p class="works-subtitle">Technical writing and automation workflows that showcase data skills</p>
            </div>

            <div style="margin-top: 16px;">
                <div class="tiles-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; max-width: 900px; margin: 0 auto; box-sizing: border-box;">
<!-- Card 1: RAPIDS vs Pandas -->
                    <div class="work-card quad-card" id="rapids-card" onclick="toggleCard('rapids-card')" style="background: linear-gradient(135deg, #76B900 0%, #4A7A00 100%); border-radius: 16px; padding: 24px; color: white; position: relative; min-height: 0; cursor: pointer;">
                        <button onclick="toggleCard('rapids-card'); event.stopPropagation();" class="card-close-x" style="position: absolute; top: 16px; right: 16px; width: 48px; height: 48px; background: rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.6); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: bold; cursor: pointer; transition: all 0.3s; display: none; align-items: center; justify-content: center; z-index: 100; line-height: 1;">&times;</button>
                        <div style="background: white; width: 48px; height: 48px; border-radius: 8px; margin-bottom: 24px; display: flex; align-items: center; justify-content: center;">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#76B900" stroke-width="1.5">
                                <rect x="6" y="6" width="12" height="12" rx="2"/>
                                <rect x="9" y="9" width="6" height="6" rx="1" fill="#76B900" stroke="none"/>
                                <line x1="8" y1="6" x2="8" y2="3"/><line x1="12" y1="6" x2="12" y2="3"/><line x1="16" y1="6" x2="16" y2="3"/>
                                <line x1="8" y1="18" x2="8" y2="21"/><line x1="12" y1="18" x2="12" y2="21"/><line x1="16" y1="18" x2="16" y2="21"/>
                                <line x1="6" y1="8" x2="3" y2="8"/><line x1="6" y1="12" x2="3" y2="12"/><line x1="6" y1="16" x2="3" y2="16"/>
                                <line x1="18" y1="8" x2="21" y2="8"/><line x1="18" y1="12" x2="21" y2="12"/><line x1="18" y1="16" x2="21" y2="16"/>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 16px;">PANDAS VS RAPIDS cuDF: GPU SPEED TEST</h3>
                        <p style="font-size: 1rem; line-height: 1.6;">Run a live simulation comparing CPU-based Pandas with NVIDIA's GPU-accelerated RAPIDS cuDF on 100M rows of paid media data.</p>
                        <div style="margin-top: 16px; text-align: center;">
                            <span style="font-size: 0.75rem; font-weight: 700; background: rgba(255,255,255,0.2); padding: 6px 16px; border-radius: 20px; white-space: nowrap; backdrop-filter: blur(4px);">Technical Writing Example 1</span>
                        </div>

                        <div class="work-details" style="position: relative;">
                            <button onclick="toggleCard('rapids-card'); event.stopPropagation();" style="position: absolute; top: -180px; right: 20px; width: 48px; height: 48px; background: rgba(255, 255, 255, 0.08); border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: 300; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; z-index: 100;" onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.borderColor='rgba(255,0,0,0.4)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='rgba(255,255,255,0.2)'; this.style.transform='scale(1)'">&times;</button>
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-top: var(--space-2); padding-top: var(--space-3);">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: var(--space-4);">

                                    <div>
                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">The Idea</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                Most data teams don't realize how much performance they leave on the table with CPU-based Pandas. I wanted to make that gap impossible to ignore. So I built an interactive speed test that visualizes CPU vs GPU performance in real time, then wrote a technical blog post breaking down RAPIDS cuDF for data engineering audiences.
                                            </p>
                                        </div>

                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">What's Inside</h4>
                                            <div style="display: flex; align-items: stretch; gap: 12px;">
                                                <div style="flex: 1; text-align: center; padding: 16px 12px; background: rgba(255,255,255,0.1); border-radius: 12px; border: 1px solid rgba(255,255,255,0.15);">
                                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">&#9654;</div>
                                                    <div style="font-weight: 700; font-size: 1rem; margin-bottom: 6px;">Interactive Speed Test</div>
                                                    <div style="font-size: 0.8rem; opacity: 0.75; line-height: 1.4;">Racing bar simulation comparing Pandas vs cuDF on 5 operations across 100M rows</div>
                                                </div>
                                                <div style="flex: 1; text-align: center; padding: 16px 12px; background: rgba(255,255,255,0.1); border-radius: 12px; border: 1px solid rgba(255,255,255,0.15);">
                                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">&#9998;</div>
                                                    <div style="font-weight: 700; font-size: 1rem; margin-bottom: 6px;">Product Blog Post</div>
                                                    <div style="font-size: 0.8rem; opacity: 0.75; line-height: 1.4;">Hypothetical NVIDIA developer blog — code samples, benchmarks, and RAPIDS ecosystem positioning</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">Key Result</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                <strong style="color: white;">41x faster groupby on 100M rows.</strong> What takes Pandas 12.4 seconds completes in 0.3 seconds on a single NVIDIA T4 GPU — with one import change. The article walks data teams through exactly why and how to switch.
                                            </p>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="scroll-section" style="text-align: center; background: rgba(255,255,255,0.1); padding: 40px 32px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2);">
                                            <div style="margin-bottom: 32px;">
                                                <span style="font-size: 0.8125rem; font-weight: 600; opacity: 0.7; text-transform: uppercase; letter-spacing: 0.1em;">Try It Yourself</span>
                                                <h3 style="font-size: 2rem; font-weight: 800; margin-top: 12px; margin-bottom: 16px;">Run the Speed Test & Read the Article</h3>
                                                <p style="font-size: 1rem; opacity: 0.85; line-height: 1.6;">
                                                    Click to launch the interactive Pandas vs cuDF benchmark, then read the full product blog post I wrote in NVIDIA's voice.
                                                </p>
                                            </div>
                                            <button onclick="document.getElementById('rapidsModal').classList.add('active'); document.body.style.overflow='hidden'; event.stopPropagation();" style="width: 100%; padding: 16px 32px; background: white; color: #4A7A00; border: none; border-radius: 12px; font-size: 1.125rem; font-weight: 700; cursor: pointer;">
                                                Launch Speed Test
                                            </button>
                                        </div>
                                    </div>

                                </div>

                                <button class="close-btn" onclick="toggleCard('rapids-card'); event.stopPropagation();">Close</button>
                            </div>
                        </div>
                    </div>

                    
<!-- Card 4: Assisted Conversions -->
                    <div class="work-card quad-card" id="conversions-card" onclick="toggleCard('conversions-card')" style="background: linear-gradient(135deg, #2563EB 0%, #1E40AF 100%); border-radius: 16px; padding: 24px; color: white; position: relative; min-height: 0; cursor: pointer;">
                        <button onclick="toggleCard('conversions-card'); event.stopPropagation();" class="card-close-x" style="position: absolute; top: 16px; right: 16px; width: 48px; height: 48px; background: rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.6); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: bold; cursor: pointer; transition: all 0.3s; display: none; align-items: center; justify-content: center; z-index: 100; line-height: 1;">&times;</button>
                        <div style="background: white; width: 48px; height: 48px; border-radius: 8px; margin-bottom: 24px; display: flex; align-items: center; justify-content: center;">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#1E40AF" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 16px; line-height: 1.3;">
                            RECONSTRUCTING CONVERSION PATHS IN SQL
                        </h3>
                        <p style="font-size: 1rem; line-height: 1.6; opacity: 0.95;">
                            A SQL pipeline that reconstructs full conversion paths by joining raw impression and click logs within configurable lookback windows. Computes touch position, path length, and interaction rank for downstream multi-touch attribution analysis.
                        </p>
                        <div style="margin-top: 16px; text-align: center;">
                            <span style="font-size: 0.75rem; font-weight: 700; background: rgba(255,255,255,0.2); padding: 6px 16px; border-radius: 20px; white-space: nowrap; backdrop-filter: blur(4px);">Technical Writing Example 2</span>
                        </div>

                        <div class="work-details" style="position: relative;">
                            <button onclick="toggleCard('conversions-card'); event.stopPropagation();" style="position: absolute; top: -180px; right: 20px; width: 48px; height: 48px; background: rgba(255, 255, 255, 0.08); border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: 300; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; z-index: 100;" onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.borderColor='rgba(255,0,0,0.4)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='rgba(255,255,255,0.2)'; this.style.transform='scale(1)'">&times;</button>
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-top: var(--space-2); padding-top: var(--space-3);">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: var(--space-4);">

                                    <div>
                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">The Idea</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                Most attribution reporting stops at last-click. I built a SQL workflow that reconstructs the full path to conversion by pulling every impression and click that occurred within configurable lookback windows before a conversion event. The README documents the entire pipeline so any analyst can run it independently.
                                            </p>
                                        </div>

                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">What the Pipeline Does</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7; margin-bottom: 16px;">
                                                Given a set of conversion events, the workflow joins against raw impression and click logs to find every touchpoint that preceded a conversion within the lookback window. It then deduplicates, ranks by recency, and computes path-level metrics like <strong style="color: white;">touch position</strong>, <strong style="color: white;">path length</strong>, and <strong style="color: white;">days since first/last interaction</strong>.
                                            </p>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                The output is a flattened, touch-level dataset ready for multi-touch attribution models, channel sequencing analysis, and creative performance reporting.
                                            </p>
                                        </div>

                                        <div>
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">What the README Covers</h4>
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <div style="padding: 14px 16px; background: rgba(255,255,255,0.08); border-radius: 10px; border-left: 3px solid #60A5FA;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">6-Step SQL Pipeline</div>
                                                    <div style="font-size: 0.85rem; opacity: 0.75;">Filter, match, pull lookback interactions, deduplicate, rank, and output</div>
                                                </div>
                                                <div style="padding: 14px 16px; background: rgba(255,255,255,0.08); border-radius: 10px; border-left: 3px solid #60A5FA;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">Edge Cases + Scaling</div>
                                                    <div style="font-size: 0.85rem; opacity: 0.75;">Deduplication, long paths, missing metadata, partition-aware filtering</div>
                                                </div>
                                                <div style="padding: 14px 16px; background: rgba(255,255,255,0.08); border-radius: 10px; border-left: 3px solid #60A5FA;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">GPU Acceleration Relevance</div>
                                                    <div style="font-size: 0.85rem; opacity: 0.75;">Allowing large joins and GROUP BY to process data at scale</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="scroll-section" style="text-align: center; background: rgba(255,255,255,0.1); padding: 40px 32px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2);">
                                            <div style="margin-bottom: 32px;">
                                                <span style="font-size: 0.8125rem; font-weight: 600; opacity: 0.7; text-transform: uppercase; letter-spacing: 0.1em;">Read the Full Doc</span>
                                                <h3 style="font-size: 2rem; font-weight: 800; margin-top: 12px; margin-bottom: 16px;">Open the README</h3>
                                                <p style="font-size: 1rem; opacity: 0.85; line-height: 1.6;">
                                                    The full SQL pipeline documentation. Walks through every step of reconstructing conversion paths from raw impression and click data.
                                                </p>
                                            </div>
                                            <button onclick="document.getElementById('conversionsModal').classList.add('active'); document.body.style.overflow='hidden'; event.stopPropagation();" style="width: 100%; padding: 16px 32px; background: white; color: #1E40AF; border: none; border-radius: 12px; font-size: 1.125rem; font-weight: 700; cursor: pointer;">
                                                Open Documentation
                                            </button>
                                        </div>
                                    </div>

                                </div>

                                <button class="close-btn" onclick="toggleCard('conversions-card'); event.stopPropagation();">Close</button>
                            </div>
                        </div>
                    </div>
<!-- Card 2: Social Listening -->
                    <div class="work-card quad-card" id="social-card" onclick="toggleCard('social-card')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 24px; color: white; position: relative; min-height: 0; cursor: pointer;">
                        <button onclick="toggleCard('social-card'); event.stopPropagation();" class="card-close-x" style="position: absolute; top: 16px; right: 16px; width: 48px; height: 48px; background: rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.6); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: bold; cursor: pointer; transition: all 0.3s; display: none; align-items: center; justify-content: center; z-index: 100; line-height: 1;">&times;</button>
                        <div style="background: white; width: 48px; height: 48px; border-radius: 8px; margin-bottom: 24px; display: flex; align-items: center; justify-content: center;">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 12h3"></path><path d="M6 8v8"></path><path d="M9 5v14"></path><path d="M12 3v18"></path><path d="M15 5v14"></path><path d="M18 8v8"></path><path d="M21 12h-3"></path>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 16px; line-height: 1.3;">
                            TRACK USER PRODUCT SENTIMENT ACROSS REDDIT & HACKER NEWS
                        </h3>
                        <p style="font-size: 1rem; line-height: 1.6; opacity: 0.95;">
                            Automates user sentiment tracking for product teams. Scrapes Reddit and Hacker News daily, analyzes feedback, and emails a 30-second audio summary.
                        </p>
                        <div style="margin-top: 16px; text-align: center;">
                            <span style="font-size: 0.75rem; font-weight: 700; background: rgba(255,255,255,0.2); padding: 6px 16px; border-radius: 20px; white-space: nowrap; backdrop-filter: blur(4px);">Automation Workflow</span>
                        </div>

                        <div class="work-details" style="position: relative;">
                            <button onclick="toggleCard('social-card'); event.stopPropagation();" style="position: absolute; top: -180px; right: 20px; width: 48px; height: 48px; background: rgba(255, 255, 255, 0.08); border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: 300; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; z-index: 100;" onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.borderColor='rgba(255,0,0,0.4)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='rgba(255,255,255,0.2)'; this.style.transform='scale(1)'">&times;</button>
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-top: var(--space-2); padding-top: var(--space-3);">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: var(--space-4);">

                                    <div>
                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">The Idea</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                NVIDIA product managers need to track user sentiment to prioritize product features and understand pain points, but checking Reddit and Hacker News daily takes hours. Automate the entire process.
                                            </p>
                                        </div>
                

                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">What I Built</h4>
                                            <div style="display: flex; align-items: flex-start; gap: 0;">
                                                <div style="flex: 1; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.08); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">Scrape</div>
                                                    <div style="font-size: 0.75rem; opacity: 0.7;">Reddit & HN</div>
                                                    <div style="font-size: 0.65rem; opacity: 0.45; margin-top: 2px;">Python + APIs</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; opacity: 0.4; font-size: 1.2rem;">&#8594;</div>
                                                <div style="flex: 1; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.08); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">Analyze</div>
                                                    <div style="font-size: 0.75rem; opacity: 0.7;">Sentiment</div>
                                                    <div style="font-size: 0.65rem; opacity: 0.45; margin-top: 2px;">OpenAI API</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; opacity: 0.4; font-size: 1.2rem;">&#8594;</div>
                                                <div style="flex: 1; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.08); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">Generate</div>
                                                    <div style="font-size: 0.75rem; opacity: 0.7;">Audio Brief</div>
                                                    <div style="font-size: 0.65rem; opacity: 0.45; margin-top: 2px;">Google TTS</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; opacity: 0.4; font-size: 1.2rem;">&#8594;</div>
                                                <div style="flex: 1; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.08); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px;">Email</div>
                                                    <div style="font-size: 0.75rem; opacity: 0.7;">Auto-deliver</div>
                                                    <div style="font-size: 0.65rem; opacity: 0.45; margin-top: 2px;">Brevo API</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px;">The Impact</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7;">
                                                Daily automated insights from Reddit & Hacker News on product sentiment. Zero manual work. Always fresh data.
                                            </p>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="scroll-section" style="text-align: center; background: rgba(255,255,255,0.1); padding: 40px 32px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2);">
                                            <div style="margin-bottom: 32px;">
                                                <span style="font-size: 0.8125rem; font-weight: 600; opacity: 0.7; text-transform: uppercase; letter-spacing: 0.1em;">See It In Action</span>
                                                <h3 style="font-size: 2rem; font-weight: 800; margin-top: 12px; margin-bottom: 16px;">Try the workflow</h3>
                                                <p style="font-size: 1rem; opacity: 0.85; line-height: 1.6;">
                                                    Get a sample email with real sentiment data and an audio briefing.
                                                </p>
                                            </div>
                                            <form id="socialListeningForm" onclick="event.stopPropagation()">
                                                <div style="margin-bottom: var(--space-3); text-align: left;">
                                                    <label style="display: block; margin-bottom: var(--space-2); font-weight: 600;">Your Name</label>
                                                    <input type="text" id="nameInput" placeholder="John Doe" required
                                                        style="width: 100%; padding: 16px; border: 2px solid rgba(255,255,255,0.3); border-radius: 12px; background: rgba(255, 255, 255, 0.95); font-size: 1rem; color: #000;">
                                                </div>
                                                <div style="margin-bottom: var(--space-4); text-align: left;">
                                                    <label style="display: block; margin-bottom: var(--space-2); font-weight: 600;">Your Email</label>
                                                    <input type="email" id="emailInput" placeholder="john@example.com" required
                                                        style="width: 100%; padding: 16px; border: 2px solid rgba(255,255,255,0.3); border-radius: 12px; background: rgba(255, 255, 255, 0.95); font-size: 1rem; color: #000;">
                                                </div>
                                                <button type="submit" style="width: 100%; padding: 16px 32px; background: white; color: #667eea; border: none; border-radius: 12px; font-size: 1.125rem; font-weight: 700; cursor: pointer;">
                                                    Send Me the Demo Report
                                                </button>
                                                <div id="demoResult" style="margin-top: var(--space-4); padding: var(--space-3); background: rgba(255, 255, 255, 0.1); border-radius: 12px; display: none;"></div>
                                            </form>
                                        </div>
                                    </div>

                                </div>

                                <button class="close-btn" onclick="toggleCard('social-card'); event.stopPropagation();">Close</button>
                            </div>
                        </div>
                    </div>

                    
<!-- Card 3: SPOTIFY TRENDS -->
                    <div class="work-card quad-card" id="spotify-card" onclick="toggleCard('spotify-card')" style="background: linear-gradient(135deg, #0d4d25 0%, #1a7a3a 100%); border-radius: 16px; padding: 24px; color: white; position: relative; min-height: 0; cursor: pointer;">
                        <button onclick="toggleCard('spotify-card'); event.stopPropagation();" class="card-close-x" style="position: absolute; top: 16px; right: 16px; width: 48px; height: 48px; background: rgba(0,0,0,0.35); border: 2px solid rgba(255,255,255,0.6); border-radius: 50%; color: #FFFFFF; font-size: 28px; font-weight: bold; cursor: pointer; transition: all 0.3s; display: none; align-items: center; justify-content: center; z-index: 100; line-height: 1;">&times;</button>
                        <div style="background: white; width: 48px; height: 48px; border-radius: 8px; margin-bottom: 24px; display: flex; align-items: center; justify-content: center;">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#1DB954" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 800; margin-bottom: 16px; line-height: 1.3; color: #ffffff;">
                            SPOTIFY TRENDS: 13 YEARS OF LISTENING
                        </h3>
                        <p style="font-size: 1rem; line-height: 1.6; color: rgba(255,255,255,0.9); font-weight: 500;">
                            Visualizes 13+ years of Spotify data showing artist evolution, top tracks, and listening patterns from 2012-2026. 6,500+ hours analyzed.
                        </p>
                        <div style="margin-top: 16px; text-align: center;">
                            <span style="font-size: 0.75rem; font-weight: 700; background: rgba(255,255,255,0.15); color: #fff; padding: 6px 16px; border-radius: 20px; white-space: nowrap; backdrop-filter: blur(4px);">Automation Workflow & Real-Time Dashboard</span>
                        </div>

                        <div class="work-details" style="position: relative;">
                            <button onclick="toggleCard('spotify-card'); event.stopPropagation();" style="position: absolute; top: -180px; right: 20px; width: 48px; height: 48px; background: rgba(255,255,255,0.08); border: 2px solid rgba(255,255,255,0.2); border-radius: 50%; color: #fff; font-size: 28px; font-weight: 300; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; z-index: 100;" onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.borderColor='rgba(255,0,0,0.4)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='rgba(255,255,255,0.2)'; this.style.transform='scale(1)'">&times;</button>
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-top: var(--space-2); padding-top: var(--space-3);">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: var(--space-4);">

                                    <div>
                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px; color: #fff;">The Idea</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7; color: rgba(255,255,255,0.9);">
                                                Spotify Wrapped only gives you a snapshot of one year. What if you could reimagine it across a time horizon of over a decade, updated daily? That is what this project does. It takes 13+ years of listening data and turns it into a living, interactive dashboard that reveals how taste actually evolves over time.
                                            </p>
                                        </div>

                                        <div style="margin-bottom: 24px;">
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 20px; color: #fff;">What I Built</h4>
                                            <div class="pipeline-flow" style="display: flex; align-items: flex-start; gap: 0; flex-wrap: wrap;">
                                                <div style="flex: 1; min-width: 80px; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; color: #fff;">Export</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Spotify Privacy</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.75); margin-top: 2px;">Raw History</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; color: rgba(255,255,255,0.7); font-size: 1.2rem;">&rarr;</div>
                                                <div style="flex: 1; min-width: 80px; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; color: #fff;">Analyze</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Python + Pandas</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.75); margin-top: 2px;">Clean & Pattern</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; color: rgba(255,255,255,0.7); font-size: 1.2rem;">&rarr;</div>
                                                <div style="flex: 1; min-width: 80px; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; color: #fff;">Visualize</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Chart.js</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.75); margin-top: 2px;">Dashboard</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; color: rgba(255,255,255,0.7); font-size: 1.2rem;">&rarr;</div>
                                                <div style="flex: 1; min-width: 80px; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; color: #fff;">Deploy</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">GitHub Pages</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.75); margin-top: 2px;">Live Site</div>
                                                </div>
                                                <div style="display: flex; align-items: center; padding: 0 4px; color: rgba(255,255,255,0.7); font-size: 1.2rem;">&rarr;</div>
                                                <div style="flex: 1; min-width: 80px; text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                                    <div style="font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; color: #fff;">Automate</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Spotify API</div>
                                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.75); margin-top: 2px;">CI/CD Daily</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h4 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 16px; color: #fff;">The Impact</h4>
                                            <p style="font-size: 1.0625rem; line-height: 1.7; color: rgba(255,255,255,0.9);">
                                                A fully interactive dashboard analyzing 6,500+ hours across 4,800+ unique artists. Updated daily via CI/CD. Reveals clear listening eras, from A Cappella and Broadway roots to R&B and Indie dominance, across a 13-year time horizon that Spotify Wrapped never shows you.
                                            </p>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="scroll-section" style="text-align: center; background: rgba(255,255,255,0.08); padding: 40px 32px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.15);">
                                            <div style="margin-bottom: 32px;">
                                                <span style="font-size: 0.8125rem; font-weight: 600; color: rgba(255,255,255,0.6); text-transform: uppercase; letter-spacing: 0.1em;">See It In Action</span>
                                                <h3 style="font-size: 2rem; font-weight: 800; margin-top: 12px; margin-bottom: 16px; color: #fff;">Dive into the data</h3>
                                                <p style="font-size: 1rem; color: rgba(255,255,255,0.8); line-height: 1.6;">
                                                    Experience the full dashboard with interactive charts and deep listening history.
                                                </p>
                                            </div>
                                            <button onclick="openSpotifyDashboard(); event.stopPropagation();" style="width: 100%; padding: 16px 32px; background: #fff; color: #0d4d25; border: none; border-radius: 12px; font-size: 1.125rem; font-weight: 700; cursor: pointer;">
                                                Explore Cory's Historical Dashboard
                                            </button>
                                        </div>
                                    </div>

                                </div>

                                <button class="close-btn" onclick="toggleCard('spotify-card'); event.stopPropagation();" style="background: rgba(255,255,255,0.15); border: 2px solid rgba(255,255,255,0.2); color: #fff;">Close</button>
                            </div>
                        </div>
                    </div>

                    
                </div>
            </div>
        </div>
    </section>
            </div>
        </div>
    </section>

    <!-- FULLSCREEN BLACK DASHBOARD -->
    <div id="spotifyModal" class="fullscreen-modal">
        <button class="modal-close-btn" onclick="closeSpotifyDashboard()">&times;</button>

        <div class="dashboard-container">
            <div class="dashboard-header">
                <div>
                    <h1 class="dashboard-title">Spotify Listening Analytics</h1>
                    <p class="dashboard-subtitle">Data through February 25, 2026 | 2012-2026</p>
                </div>
            </div>

            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('overview', event)">Overview</button>
                <button class="tab-btn" onclick="switchTab('evolution', event)">Artist Evolution</button>
                <button class="tab-btn" onclick="switchTab('genres', event)">Genre Evolution</button>
                <button class="tab-btn" onclick="switchTab('charts', event)">Charts & Trends</button>
                <button class="tab-btn" onclick="switchTab('insights', event)">Word Cloud</button>
            </div>

            <div id="dashboardContent">
                <p style="text-align: center; padding: var(--space-8); color: rgba(255,255,255,0.5);">Loading analytics...</p>
            </div>
        </div>
    </div>

    <script>
        // Prevent browser scroll restoration - always start at top
        if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
        window.scrollTo(0, 0);
        if (window.location.hash) {
            history.replaceState(null, '', window.location.pathname + window.location.search);
            window.scrollTo(0, 0);
        }

        const SPOTIFY_DATA = { stats: null, artistEvolution: null, monthlyTrends: null, topSongs: null };
        let currentTab = 'overview';
        let selectedYear = 'all';
        let currentEvolutionIndex = 0;

        async function loadSpotifyData() {
            try {
                const [stats, artistEvolution, monthlyTrends, topSongs] = await Promise.all([
                    fetch('spotify-trends/basic_stats.json').then(r => r.json()),
                    fetch('spotify-trends/artist_evolution.json').then(r => r.json()),
                    fetch('spotify-trends/monthly_trends.json').then(r => r.json()),
                    fetch('spotify-trends/top_songs_by_period.json').then(r => r.json())
                ]);

                SPOTIFY_DATA.stats = stats;
                SPOTIFY_DATA.artistEvolution = artistEvolution;
                SPOTIFY_DATA.monthlyTrends = monthlyTrends;
                SPOTIFY_DATA.topSongs = topSongs;

                // Filter out unwanted artists
                filterOutArtist('Meghan Trainor');
                filterOutArtist('Unknown');

                return true;
            } catch (error) {
                console.error('Error loading Spotify data:', error);
                return false;
            }
        }

        function filterOutArtist(artistName) {
            const artistLower = artistName.toLowerCase();

            if (SPOTIFY_DATA.stats && SPOTIFY_DATA.stats.top_artists_all_time) {
                delete SPOTIFY_DATA.stats.top_artists_all_time[artistName];
            }

            if (SPOTIFY_DATA.stats && SPOTIFY_DATA.stats.top_tracks_all_time) {
                SPOTIFY_DATA.stats.top_tracks_all_time = SPOTIFY_DATA.stats.top_tracks_all_time.filter(
                    track => track.artist.toLowerCase() !== artistLower
                );
            }

            if (SPOTIFY_DATA.artistEvolution) {
                Object.keys(SPOTIFY_DATA.artistEvolution).forEach(year => {
                    SPOTIFY_DATA.artistEvolution[year] = SPOTIFY_DATA.artistEvolution[year].filter(
                        artist => artist.artist.toLowerCase() !== artistLower
                    );
                });
            }
        }

        async function openSpotifyDashboard() {
            const modal = document.getElementById('spotifyModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            if (!SPOTIFY_DATA.stats) {
                await loadSpotifyData();
            }
            switchTab('overview');
        }

        function closeSpotifyDashboard() {
            document.getElementById('spotifyModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function switchTab(tabName, event) {
            currentTab = tabName;

            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));

            // Find and activate the correct tab button
            const tabButtons = {
                'overview': 0,
                'evolution': 1,
                'genres': 2,
                'charts': 3,
                'insights': 4
            };

            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                const buttons = document.querySelectorAll('.tab-btn');
                if (buttons[tabButtons[tabName]]) {
                    buttons[tabButtons[tabName]].classList.add('active');
                }
            }

            renderTabContent(tabName);
        }

        function renderTabContent(tabName) {
            const content = document.getElementById('dashboardContent');

            switch(tabName) {
                case 'overview':
                    content.innerHTML = '<div style="text-align:center;color:rgba(255,255,255,0.7);font-size:15px;margin:0 auto 24px;max-width:600px;line-height:1.5;">A snapshot of my listening history across 13+ years. These numbers represent every song, every artist, and every late-night listening session since 2012.</div>' + renderOverviewTab();
                    break;
                case 'evolution':
                    content.innerHTML = '<div style="text-align:center;color:rgba(255,255,255,0.7);font-size:15px;margin:0 auto 24px;max-width:600px;line-height:1.5;">How my top artists have shifted year over year. Use the carousel to travel through time and see who defined each era of my listening.</div>' + renderEvolutionTab();
                    currentEvolutionIndex = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort().length - 1;
                    renderEvolutionPanels();
                    break;
                case 'genres':
                    content.innerHTML = '<div style="text-align:center;color:rgba(255,255,255,0.7);font-size:15px;margin:0 auto 24px;max-width:600px;line-height:1.5;">A look at how my genre preferences have evolved over the years. Each artist is mapped to their real genre based on my actual listening data.</div>' + renderGenresTab();
                    setTimeout(() => renderGenreChart(), 100);
                    break;
                case 'charts':
                    content.innerHTML = '<div style="text-align:center;color:rgba(255,255,255,0.7);font-size:15px;margin:0 auto 24px;max-width:600px;line-height:1.5;">The deeper trends behind my listening habits, from monthly patterns to yearly totals. These charts tell the story of how music fits into my life.</div>' + renderChartsTab();
                    setTimeout(() => renderCharts(), 100);
                    break;
                case 'insights':
                    content.innerHTML = '<div style="text-align:center;color:rgba(255,255,255,0.7);font-size:15px;margin:0 auto 24px;max-width:600px;line-height:1.5;">Artist and track names broken down into a word cloud. Use the slider to explore how the words defining my music have shifted year by year.</div>' + renderInsightsTab();
                    setTimeout(() => {
                        const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();
                        const latestYear = years[years.length - 1];
                        generateWordCloud(latestYear);
                    }, 100);
                    break;
            }
        }

        function renderOverviewTab() {
            const stats = SPOTIFY_DATA.stats;
            if (!stats) return '<p>Loading...</p>';

            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${(stats.total_hours / 1000).toFixed(1)}k</div>
                        <div class="stat-label">Hours Listened</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(stats.total_plays / 1000).toFixed(1)}k</div>
                        <div class="stat-label">Total Plays</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(stats.unique_tracks / 1000).toFixed(1)}k</div>
                        <div class="stat-label">Unique Tracks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(stats.unique_artists / 1000).toFixed(1)}k</div>
                        <div class="stat-label">Unique Artists</div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-6); margin-top: var(--space-6); align-items: stretch; grid-auto-rows: 1fr;">
                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">Top Artists (All Time)</div>
                        </div>
                        ${Object.entries(stats.top_artists_all_time).slice(0, 10).map(([artist, count], i) => `
                            <div class="table-row">
                                <div class="rank">#${i + 1}</div>
                                <div class="item-info">
                                    <div class="item-name">${artist}</div>
                                </div>
                                <div class="item-count">${count.toLocaleString()} plays</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">Top Tracks (All Time)</div>
                        </div>
                        ${stats.top_tracks_all_time.slice(0, 10).map((item, i) => `
                            <div class="table-row">
                                <div class="rank">#${i + 1}</div>
                                <div class="item-info">
                                    <div class="item-name">${item.track}</div>
                                    <div class="item-detail">${item.artist}</div>
                                </div>
                                <div class="item-count">${item.play_count.toLocaleString()}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderEvolutionTab() {
            const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();

            return `
                <div class="evolution-controls">
                    <button class="evolution-btn" id="prevBtn" onclick="changeEvolutionYear(-1)">&larr; Previous</button>
                    <div class="evolution-year-display" id="evolutionYearDisplay">${years[years.length - 1]}</div>
                    <button class="evolution-btn" id="nextBtn" onclick="changeEvolutionYear(1)">Next &rarr;</button>
                </div>

                <div id="evolutionPanelsContainer"></div>
            `;
        }

        function changeEvolutionYear(direction) {
            const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();
            currentEvolutionIndex = Math.max(0, Math.min(years.length - 1, currentEvolutionIndex + direction));
            renderEvolutionPanels();
        }

        function renderEvolutionPanels() {
            const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();
            const container = document.getElementById('evolutionPanelsContainer');

            if (!container) return;

            let panelsToShow = [];
            let isPanelLayout = 'three';

            if (currentEvolutionIndex === 0) {
                panelsToShow = [0, 1];
                isPanelLayout = 'two';
            } else if (currentEvolutionIndex === years.length - 1) {
                panelsToShow = [years.length - 2, years.length - 1];
                isPanelLayout = 'two';
            } else {
                panelsToShow = [currentEvolutionIndex - 1, currentEvolutionIndex, currentEvolutionIndex + 1];
            }

            // Update button states
            document.getElementById('prevBtn').disabled = currentEvolutionIndex === 0;
            document.getElementById('nextBtn').disabled = currentEvolutionIndex === years.length - 1;

            // Update year display
            document.getElementById('evolutionYearDisplay').textContent = years[currentEvolutionIndex];

            // Build panels HTML
            const panelsHTML = panelsToShow.map((idx, panelNum) => {
                const year = years[idx];
                const isCurrent = idx === currentEvolutionIndex;
                const evolution = SPOTIFY_DATA.artistEvolution[year];

                // Get previous year rankings for comparison
                let previousYearRankings = {};
                if (idx > 0) {
                    const prevYear = years[idx - 1];
                    if (SPOTIFY_DATA.artistEvolution[prevYear]) {
                        SPOTIFY_DATA.artistEvolution[prevYear].forEach((artist, rankIdx) => {
                            previousYearRankings[artist.artist] = rankIdx + 1;
                        });
                    }
                }

                const artistsHTML = evolution.slice(0, 10).map((artist, rankIdx) => {
                    const currentRank = rankIdx + 1;
                    const previousRank = previousYearRankings[artist.artist];

                    let changeHTML = '';
                    let changeClass = 'neutral';

                    if (!previousRank || previousRank > 10) {
                        changeHTML = 'NEW';
                        changeClass = 'new';
                    } else {
                        const change = previousRank - currentRank;
                        if (change > 0) {
                            changeHTML = `&#8593;${change}`;
                            changeClass = 'up';
                        } else if (change < 0) {
                            changeHTML = `&#8595;${Math.abs(change)}`;
                            changeClass = 'down';
                        } else {
                            changeHTML = '&mdash;';
                            changeClass = 'neutral';
                        }
                    }

                    return `
                        <div class="evolution-artist-row">
                            <div class="evolution-rank">#${currentRank}</div>
                            <div class="evolution-artist-name">${artist.artist}</div>
                            <div class="evolution-change ${changeClass}">${changeHTML}</div>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="evolution-panel ${isCurrent ? 'current' : ''}">
                        <div class="evolution-panel-title">${year}</div>
                        ${artistsHTML}
                    </div>
                `;
            }).join('');

            container.innerHTML = `<div class="evolution-panels ${isPanelLayout === 'two' ? 'two-panels' : ''}">${panelsHTML}</div>`;
        }

        function renderGenresTab() {
            return `

                <div class="chart-container" style="height: 500px;">
                    <div class="chart-title">Genre Distribution Over Time</div>
                    <canvas id="genreChart"></canvas>
                </div>
            `;
        }

        function renderGenreChart() {
            const ctx = document.getElementById('genreChart');
            if (!ctx) return;

            const genreData = {
                "2012":{"A Cappella":100},
                "2013":{"Jazz Pop":70.6,"A Cappella":17.6,"Broadway":8.8,"Pop":2.9},
                "2014":{"Broadway":57.4,"Pop":22.8,"Jazz Pop":10.6,"A Cappella":9.2},
                "2015":{"Broadway":30.3,"Pop":26.4,"A Cappella":22.7,"Jazz Pop":20.6},
                "2016":{"A Cappella":55,"Broadway":27.3,"Pop":12.2,"R&B / Soul":5.5},
                "2017":{"A Cappella":37.8,"Broadway":21.9,"Pop":21.4,"R&B / Soul":10.4,"Jazz Pop":8.4},
                "2018":{"A Cappella":48.8,"R&B / Soul":18.2,"Pop":17.8,"Broadway":10.3,"Jazz Pop":4.7},
                "2019":{"R&B / Soul":46.4,"Pop":33.8,"Gospel":8,"Broadway":7.3,"A Cappella":4.5},
                "2020":{"R&B / Soul":29,"Gospel":19.5,"Pop":16.9,"Indie / Singer-Songwriter":14.2,"Broadway":6.8,"A Cappella":5.9},
                "2021":{"Indie / Singer-Songwriter":44.4,"Pop":14.8,"R&B / Soul":11.1,"Electronic":11,"Broadway":6.4},
                "2022":{"R&B / Soul":36.8,"Pop":30.3,"Indie / Singer-Songwriter":27.5,"A Cappella":5.4},
                "2023":{"R&B / Soul":49.7,"Indie / Singer-Songwriter":33,"Pop":17.4},
                "2024":{"Pop":40.6,"Indie / Singer-Songwriter":30.2,"R&B / Soul":29.1},
                "2025":{"Indie / Singer-Songwriter":54.8,"Pop":23.4,"R&B / Soul":21.8},
                "2026":{"Indie / Singer-Songwriter":81.8,"Pop":8.8,"A Cappella":4.9,"Electronic":4.4}
            };

            const genres = ["A Cappella", "Broadway", "Pop", "R&B / Soul", "Indie / Singer-Songwriter", "Jazz Pop", "Gospel", "Electronic"];
            const colors = {
                "A Cappella": "#8b5cf6",
                "Broadway": "#f59e0b",
                "Pop": "#ec4899",
                "R&B / Soul": "#1DB954",
                "Indie / Singer-Songwriter": "#3b82f6",
                "Jazz Pop": "#14b8a6",
                "Gospel": "#f97316",
                "Electronic": "#06b6d4"
            };

            const years = Object.keys(genreData).sort();
            const datasets = genres.map(genre => {
                const data = years.map(year => genreData[year][genre] || 0);
                return {
                    label: genre,
                    data: data,
                    borderColor: colors[genre],
                    backgroundColor: colors[genre] + '1a',
                    borderWidth: 3,
                    tension: 0.4,
                    fill: true
                };
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: 'rgba(255, 255, 255, 0.8)' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#1DB954',
                            bodyColor: '#FFFFFF',
                            borderColor: '#1DB954',
                            borderWidth: 1,
                            padding: 16,
                            displayColors: true,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 12 },
                            callbacks: {
                                title: function(context) {
                                    return context[0].label + ' Genre Breakdown';
                                },
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: 'rgba(255, 255, 255, 0.7)', callback: function(value) { return value + '%'; } },
                            title: { display: true, text: 'Percentage', color: 'rgba(255, 255, 255, 0.7)' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                        }
                    }
                }
            });
        }

        function renderChartsTab() {
            return `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-4); margin-bottom: var(--space-4);">
                    <div class="chart-container">
                        <div class="chart-title">Listening Hours Over Time</div>
                        <canvas id="hoursChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">Total Plays by Year</div>
                        <canvas id="playsChart"></canvas>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-4); margin-bottom: var(--space-4);">
                    <div class="chart-container">
                        <div class="chart-title">Top 10 Artists (All Time)</div>
                        <canvas id="topArtistsChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">Monthly Listening Pattern</div>
                        <canvas id="monthlyPatternChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Listening Activity Timeline</div>
                    <canvas id="activityTimelineChart"></canvas>
                </div>
            `;
        }

        function renderInsightsTab() {
            const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();
            const yearCount = years.length;

            return `

                <div class="year-filter-container">
                    <div class="year-filter-header">
                        <div class="year-filter-label">Select Year</div>
                        <div class="year-display" id="wordCloudYearDisplay">${years[yearCount - 1]}</div>
                    </div>
                    <div class="year-slider-wrapper">
                        <input type="range" class="year-slider" id="wordCloudYearSlider"
                               min="0" max="${yearCount - 1}" value="${yearCount - 1}"
                               oninput="updateWordCloudYear(this.value)">
                        <div class="year-marks" id="wordCloudYearMarks">
                            <div class="year-mark">${years[0]}</div>
                            <div class="year-mark">${years[yearCount - 1]}</div>
                        </div>
                    </div>
                </div>

                <div class="word-cloud-container" id="wordCloud"></div>
            `;
        }

        function generateWordCloud(year) {
            if (!SPOTIFY_DATA.stats && !SPOTIFY_DATA.topSongs) return;

            const stopWords = ['the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by', 'from', 'feat', 'ft'];
            const wordFreq = {};

            // Get data source for the specific year
            let dataSource = [];
            if (SPOTIFY_DATA.topSongs && SPOTIFY_DATA.topSongs[year]) {
                dataSource = SPOTIFY_DATA.topSongs[year];
            } else if (SPOTIFY_DATA.artistEvolution && SPOTIFY_DATA.artistEvolution[year]) {
                // Fallback: use artist names from artist evolution data
                SPOTIFY_DATA.artistEvolution[year].forEach(item => {
                    const words = item.artist.toLowerCase().split(/[\s\-_.,!?;:()\[\]{}'"&/\\]+/);
                    words.forEach(word => {
                        if (word.length > 2 && !stopWords.includes(word)) {
                            wordFreq[word] = (wordFreq[word] || 0) + item.play_count;
                        }
                    });
                });
            }

            // Process track data if available
            if (dataSource.length > 0) {
                dataSource.forEach(item => {
                    const words = `${item.track || ''} ${item.artist || ''}`.toLowerCase().split(/[\s\-_.,!?;:()\[\]{}'"&/\\]+/);
                    words.forEach(word => {
                        if (word.length > 2 && !stopWords.includes(word)) {
                            wordFreq[word] = (wordFreq[word] || 0) + (item.play_count || 0);
                        }
                    });
                });
            }

            const sortedWords = Object.entries(wordFreq)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 50);

            if (sortedWords.length === 0) {
                const cloudDiv = document.getElementById('wordCloud');
                if (cloudDiv) {
                    cloudDiv.innerHTML = '<p style="color: rgba(255,255,255,0.5);">No data available for this year</p>';
                }
                return;
            }

            const maxFreq = sortedWords[0][1];
            const minFreq = sortedWords[sortedWords.length - 1][1];

            const cloudDiv = document.getElementById('wordCloud');
            if (cloudDiv) {
                cloudDiv.innerHTML = sortedWords.map(([word, freq]) => {
                    const size = 14 + ((freq - minFreq) / (maxFreq - minFreq)) * 60;
                    const opacity = 0.6 + ((freq - minFreq) / (maxFreq - minFreq)) * 0.4;
                    const colors = ['#1DB954', '#1ed760', '#ec4899', '#a855f7', '#3b82f6', '#f59e0b'];
                    const color = colors[Math.floor(Math.random() * colors.length)];

                    return `<span style="font-size: ${size}px; color: ${color}; opacity: ${opacity}; font-weight: 800; padding: 6px 12px; transition: all 0.3s ease; cursor: default;" onmouseover="this.style.transform='scale(1.3)'; this.style.opacity='1';" onmouseout="this.style.transform='scale(1)'; this.style.opacity='${opacity}';">${word}</span>`;
                }).join('');
            }
        }

        function updateWordCloudYear(value) {
            const years = Object.keys(SPOTIFY_DATA.artistEvolution || {}).sort();
            const index = parseInt(value);
            const year = years[index];

            document.getElementById('wordCloudYearDisplay').textContent = year;

            const yearMarks = document.getElementById('wordCloudYearMarks');
            if (yearMarks) {
                yearMarks.innerHTML = `
                    <div class="year-mark">${years[0]}</div>
                    <div class="year-mark">${years[years.length - 1]}</div>
                `;
            }

            generateWordCloud(year);
        }

        function renderCharts() {
            if (!SPOTIFY_DATA.monthlyTrends) return;

            const monthlyData = SPOTIFY_DATA.monthlyTrends;

            const hoursCtx = document.getElementById('hoursChart');
            if (hoursCtx) {
                new Chart(hoursCtx, {
                    type: 'line',
                    data: {
                        labels: monthlyData.map(d => d.year_month),
                        datasets: [{
                            label: 'Hours',
                            data: monthlyData.map(d => d.minutes_played / 60),
                            borderColor: '#1DB954',
                            backgroundColor: 'rgba(29, 185, 84, 0.2)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#1DB954',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#1DB954',
                                bodyColor: '#FFFFFF',
                                borderColor: '#1DB954',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.y.toFixed(1) + ' hours';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)', maxTicksLimit: 12 }
                            }
                        }
                    }
                });
            }

            const yearlyPlays = {};
            monthlyData.forEach(d => {
                if (d && d.year_month && typeof d.year_month === 'string') {
                    const year = d.year_month.split('-')[0];
                    yearlyPlays[year] = (yearlyPlays[year] || 0) + d.play_count;
                }
            });

            const playsCtx = document.getElementById('playsChart');
            if (playsCtx) {
                new Chart(playsCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(yearlyPlays),
                        datasets: [{
                            label: 'Plays',
                            data: Object.values(yearlyPlays),
                            backgroundColor: 'rgba(29, 185, 84, 0.8)',
                            borderColor: '#1DB954',
                            borderWidth: 2,
                            borderRadius: 8,
                            hoverBackgroundColor: 'rgba(29, 185, 84, 1)',
                            hoverBorderColor: '#1DB954',
                            hoverBorderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#1DB954',
                                bodyColor: '#FFFFFF',
                                borderColor: '#1DB954',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.y.toLocaleString() + ' plays';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const year = Object.keys(yearlyPlays)[elements[0].index];
                                const plays = Object.values(yearlyPlays)[elements[0].index];
                                alert(`${year}: ${plays.toLocaleString()} total plays`);
                            }
                        }
                    }
                });
            }

            // Chart 3: Top 10 Artists (Horizontal Bar)
            const topArtistsCtx = document.getElementById('topArtistsChart');
            if (topArtistsCtx && SPOTIFY_DATA.stats) {
                const topArtists = Object.entries(SPOTIFY_DATA.stats.top_artists_all_time).slice(0, 10);
                new Chart(topArtistsCtx, {
                    type: 'bar',
                    data: {
                        labels: topArtists.map(([artist]) => artist),
                        datasets: [{
                            label: 'Plays',
                            data: topArtists.map(([, count]) => count),
                            backgroundColor: [
                                'rgba(29, 185, 84, 0.9)',
                                'rgba(139, 92, 246, 0.9)',
                                'rgba(236, 72, 153, 0.9)',
                                'rgba(59, 130, 246, 0.9)',
                                'rgba(245, 158, 11, 0.9)',
                                'rgba(239, 68, 68, 0.9)',
                                'rgba(99, 102, 241, 0.9)',
                                'rgba(16, 185, 129, 0.9)',
                                'rgba(251, 146, 60, 0.9)',
                                'rgba(168, 85, 247, 0.9)'
                            ],
                            borderRadius: 8,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#1DB954',
                                bodyColor: '#FFFFFF',
                                borderColor: '#1DB954',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.x.toLocaleString() + ' plays';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            },
                            y: {
                                grid: { display: false },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const index = elements[0].index;
                                const artist = topArtists[index][0];
                                alert(`${artist}: ${topArtists[index][1].toLocaleString()} total plays`);
                            }
                        }
                    }
                });
            }

            // Chart 4: Monthly Listening Pattern (Average by Month)
            const monthlyPatternCtx = document.getElementById('monthlyPatternChart');
            if (monthlyPatternCtx) {
                const monthlyAvg = {};
                monthlyData.forEach(d => {
                    if (d && d.year_month && typeof d.year_month === 'string') {
                        const month = d.year_month.split('-')[1];
                        if (!monthlyAvg[month]) monthlyAvg[month] = { total: 0, count: 0 };
                        monthlyAvg[month].total += (d.minutes_played / 60);
                        monthlyAvg[month].count += 1;
                    }
                });

                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const avgData = monthNames.map((_, i) => {
                    const monthKey = String(i + 1).padStart(2, '0');
                    return monthlyAvg[monthKey] ? monthlyAvg[monthKey].total / monthlyAvg[monthKey].count : 0;
                });

                new Chart(monthlyPatternCtx, {
                    type: 'radar',
                    data: {
                        labels: monthNames,
                        datasets: [{
                            label: 'Avg Hours',
                            data: avgData,
                            backgroundColor: 'rgba(29, 185, 84, 0.2)',
                            borderColor: '#1DB954',
                            borderWidth: 3,
                            pointBackgroundColor: '#1DB954',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#1DB954',
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#1DB954',
                                bodyColor: '#FFFFFF',
                                borderColor: '#1DB954',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.r.toFixed(1) + ' avg hours';
                                    }
                                }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)', backdropColor: 'transparent' },
                                pointLabels: { color: 'rgba(255, 255, 255, 0.8)', font: { size: 12 } }
                            }
                        }
                    }
                });
            }

            // Chart 5: Listening Activity Timeline (Area)
            const activityTimelineCtx = document.getElementById('activityTimelineChart');
            if (activityTimelineCtx) {
                new Chart(activityTimelineCtx, {
                    type: 'line',
                    data: {
                        labels: monthlyData.map(d => d.year_month),
                        datasets: [{
                            label: 'Total Plays',
                            data: monthlyData.map(d => d.play_count),
                            backgroundColor: 'rgba(139, 92, 246, 0.3)',
                            borderColor: '#8b5cf6',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#8b5cf6',
                                bodyColor: '#FFFFFF',
                                borderColor: '#8b5cf6',
                                borderWidth: 1,
                                padding: 12,
                                callbacks: {
                                    title: function(context) {
                                        return context[0].label;
                                    },
                                    label: function(context) {
                                        return context.parsed.y.toLocaleString() + ' plays';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: 'rgba(255, 255, 255, 0.7)', maxTicksLimit: 20 }
                            }
                        }
                    }
                });
            }
        }

        function toggleCard(cardId) {
            const card = document.getElementById(cardId);
            card.classList.toggle('expanded');

            if (card.classList.contains('expanded')) {
                card.style.transform = 'none';
                card.style.boxShadow = 'none';
                card.style.transition = 'none';
                setTimeout(() => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    initScrollAnimations(card);
                }, 100);
            } else {
                card.style.transform = '';
                card.style.boxShadow = '';
                card.style.transition = '';
            }
        }

        function initScrollAnimations(card) {
            const scrollContainer = card.querySelector('.work-details');
            const sections = card.querySelectorAll('.scroll-section');

            if (!scrollContainer || !sections.length) return;
            if (sections[0]) sections[0].classList.add('visible');

            scrollContainer.addEventListener('scroll', () => {
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    const containerRect = scrollContainer.getBoundingClientRect();
                    const isVisible = rect.top < containerRect.bottom - 100 && rect.bottom > containerRect.top + 100;
                    if (isVisible) section.classList.add('visible');
                });
            });

            scrollContainer.dispatchEvent(new Event('scroll'));
        }

        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw-1Ug6SYktFirnQKSSkLr6pxTExJpTXdPfEnp6RWKmnIt56fkXk4siFgIp1KjBvBeY/exec';

        document.getElementById('socialListeningForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('nameInput').value.trim();
            const email = document.getElementById('emailInput').value.trim();
            const resultDiv = document.getElementById('demoResult');

            if (!name || !email) return;

            resultDiv.innerHTML = '&#9203; Sending...';
            resultDiv.style.display = 'block';

            try {
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email })
                }).catch(err => console.log('Google Sheets:', err));

                const response = await fetch('https://coryzillergithubio-production.up.railway.app/send-demo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email })
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    resultDiv.innerHTML = `<strong>&#9989; Success!</strong><br><br>Check ${email} for the report!`;
                } else {
                    throw new Error(data.error || 'Failed');
                }
            } catch (error) {
                resultDiv.innerHTML = `<strong>&#10060; Error</strong><br><br>${error.message}`;
            }
        });
    </script>

    

    
    <!-- Work History & Education Timeline -->
    


    <!-- Work History & Education Timeline -->
    <section id="history" style="max-width: 900px; margin: 0 auto; padding: 100px 24px 120px;">
        <h2 style="font-size: 3rem; font-weight: 800; text-align: center; margin-bottom: 12px; color: #fff;">Work History &amp; Education</h2>
        <p style="text-align: center; color: rgba(255,255,255,0.7); margin-bottom: 72px; font-size: 1.125rem; font-weight: 400;">5+ years in marketing, data and analytics, and product thinking</p>

        <style>
            .tl-item { opacity: 0; transition: opacity 0.6s ease, transform 0.6s ease; }
            .tl-left { transform: translateX(-40px); }
            .tl-right { transform: translateX(40px); }
            .tl-item.visible { opacity: 1; transform: translateX(0); }
            .tl-card {
                background: rgba(255,255,255,0.09);
                border: 1px solid rgba(255,255,255,0.18);
                border-radius: 12px;
                padding: 20px 24px;
            }
            .tl-card:hover {
                background: rgba(255,255,255,0.13);
                border-color: rgba(255,255,255,0.28);
                transition: all 0.3s ease;
            }
            .tl-date {
                font-size: 0.8rem;
                font-weight: 700;
                color: rgba(255,255,255,0.8);
                text-transform: uppercase;
                letter-spacing: 0.05em;
                margin-bottom: 6px;
            }
            .tl-title {
                font-weight: 800;
                font-size: 1.2rem;
                margin-bottom: 4px;
                color: #fff;
            }
            .tl-role {
                color: rgba(255,255,255,0.95);
                font-size: 0.95rem;
                font-weight: 500;
                margin-bottom: 6px;
            }
            .tl-desc {
                color: rgba(255,255,255,0.8);
                font-size: 0.85rem;
                font-weight: 400;
                line-height: 1.5;
                margin-bottom: 10px;
            }
            .tl-dot {
                position: absolute;
                top: 24px;
                width: 14px;
                height: 14px;
                border-radius: 50%;
                border: 3px solid #1a1a2e;
                z-index: 2;
            }
            @media (max-width: 600px) {
                .tl-left, .tl-right { text-align: left !important; padding-left: 32px !important; padding-right: 0 !important; }
                .tl-left .tl-dot, .tl-right .tl-dot { left: -7px !important; right: auto !important; }
            }
        </style>

        <div style="position: relative;">
            <!-- Center line -->
            <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: rgba(255,255,255,0.1); transform: translateX(-1px);"></div>

            <!-- OSU - LEFT -->
            <div class="tl-item tl-left" style="position: relative; display: flex; margin-bottom: 24px;">
                <div style="width: 50%; padding-right: 40px; text-align: right;">
                    <div class="tl-card">
                        <div class="tl-date">Expected May 2027</div>
                        <div class="tl-title">The Ohio State University</div>
                        <div class="tl-role">STEM MBA &mdash; Fisher College of Business</div>
                    </div>
                </div>
                <div class="tl-dot" style="left: calc(50% - 7px); background: #BB0000;"></div>
                <div style="width: 50%;"></div>
            </div>

            <!-- Basis - RIGHT -->
            <div class="tl-item tl-right" style="position: relative; display: flex; margin-bottom: 24px;">
                <div style="width: 50%;"></div>
                <div class="tl-dot" style="left: calc(50% - 7px); background: #4A90D9;"></div>
                <div style="width: 50%; padding-left: 40px;">
                    <div class="tl-card">
                        <div class="tl-date">2021 &ndash; 2025 &bull; Chicago, IL</div>
                        <div class="tl-title">Basis Technologies</div>
                        <div class="tl-desc">Chicago-based advertising technology company</div>
                        <div class="tl-role">Data Analyst &rarr; Senior Data Analyst</div>
                    </div>
                </div>
            </div>

            <!-- Yelp - LEFT -->
            <div class="tl-item tl-left" style="position: relative; display: flex; margin-bottom: 24px;">
                <div style="width: 50%; padding-right: 40px; text-align: right;">
                    <div class="tl-card">
                        <div class="tl-date">2019 &ndash; 2020 &bull; Washington D.C.</div>
                        <div class="tl-title">Yelp</div>
                        <div class="tl-role">Account Executive</div>
                    </div>
                </div>
                <div class="tl-dot" style="left: calc(50% - 7px); background: #D32323;"></div>
                <div style="width: 50%;"></div>
            </div>

            <!-- Marinus - RIGHT -->
            <div class="tl-item tl-right" style="position: relative; display: flex; margin-bottom: 24px;">
                <div style="width: 50%;"></div>
                <div class="tl-dot" style="left: calc(50% - 7px); background: #7B68EE;"></div>
                <div style="width: 50%; padding-left: 40px;">
                    <div class="tl-card">
                        <div class="tl-date">2017 &ndash; 2019 &bull; Pittsburgh, PA</div>
                        <div class="tl-title">Marinus Analytics</div>
                        <div class="tl-desc">AI startup combating human trafficking with technology</div>
                        <div class="tl-role">Impact &amp; Business Development Intern</div>
                    </div>
                </div>
            </div>

            <!-- Penn State - LEFT -->
            <div class="tl-item tl-left" style="position: relative; display: flex;">
                <div style="width: 50%; padding-right: 40px; text-align: right;">
                    <div class="tl-card">
                        <div class="tl-date">2015 &ndash; 2019 &bull; State College, PA</div>
                        <div class="tl-title">Penn State University</div>
                        <div class="tl-role">BS Information Science &amp; Technology (App Design and Development) &bull; BS Applied Spanish</div>
                    </div>
                </div>
                <div class="tl-dot" style="left: calc(50% - 7px); background: #003893;"></div>
                <div style="width: 50%;"></div>
            </div>
        </div>
    </section>

    <script>
    (function() {
        var obs = new IntersectionObserver(function(entries) {
            entries.forEach(function(e) {
                if (e.isIntersecting) e.target.classList.add('visible');
            });
        }, { threshold: 0.2 });
        document.querySelectorAll('.tl-item').forEach(function(n) { obs.observe(n); });
    })();
    </script>


    <!-- Google Analytics Event Tracking -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      function trackClick(category, action, label) {
        gtag('event', action, { 'event_category': category, 'event_label': label });
      }
      document.querySelectorAll('a').forEach(function(link) {
        var t = link.textContent.trim();
        if (t === 'View LinkedIn') link.addEventListener('click', function() { trackClick('Navigation', 'click_view_linkedin', 'View LinkedIn Button'); });
        if (t === 'Side Projects') link.addEventListener('click', function() { trackClick('Navigation', 'click_side_projects', 'Side Projects Button'); });
        if (t === 'Work History') link.addEventListener('click', function() { trackClick('Navigation', 'click_work_history', 'Work History Button'); });
      });
      document.querySelectorAll('button').forEach(function(btn) {
        var t = btn.textContent.trim();
        if (t === 'Send Me the Demo Report') btn.addEventListener('click', function() { trackClick('Social_Listening', 'click_send_demo_report', 'Send Demo Report Button'); });
        if (t.includes('Explore') && t.includes('Dashboard')) btn.addEventListener('click', function() { trackClick('Spotify_Project', 'click_explore_dashboard', 'Explore Spotify Dashboard Button'); });
        if (t === 'Overview') btn.addEventListener('click', function() { trackClick('Spotify_Dashboard', 'click_overview_tab', 'Spotify Dashboard - Overview Tab'); });
        if (t === 'Artist Evolution') btn.addEventListener('click', function() { trackClick('Spotify_Dashboard', 'click_artist_evolution_tab', 'Spotify Dashboard - Artist Evolution Tab'); });
        if (t === 'Genre Evolution') btn.addEventListener('click', function() { trackClick('Spotify_Dashboard', 'click_genre_evolution_tab', 'Spotify Dashboard - Genre Evolution Tab'); });
        if (t === 'Charts & Trends') btn.addEventListener('click', function() { trackClick('Spotify_Dashboard', 'click_charts_trends_tab', 'Spotify Dashboard - Charts & Trends Tab'); });
        if (t === 'Word Cloud') btn.addEventListener('click', function() { trackClick('Spotify_Dashboard', 'click_word_cloud_tab', 'Spotify Dashboard - Word Cloud Tab'); });
      });
      document.querySelectorAll('[onclick]').forEach(function(el) {
        var oc = (el.getAttribute('onclick') || '').toLowerCase();
        if (oc.includes('sentiment') || oc.includes('reddit') || oc.includes('social')) {
          el.addEventListener('click', function() { trackClick('Project_Tiles', 'click_sentiment_tile', 'Reddit and HN Sentiment Tile'); });
        }
        if (oc.includes('spotify') || oc.includes('music') || oc.includes('listening')) {
          el.addEventListener('click', function() { trackClick('Project_Tiles', 'click_spotify_tile', 'Spotify Trends Tile'); });
        }
      });
      document.querySelectorAll('form').forEach(function(form) {
        form.addEventListener('submit', function() { trackClick('Form', 'submit_contact_form', 'Name and Email Form Submission'); });
      });
    });

        // RAPIDS Speed Test Simulation
        function runRapidsSimulation() {
            const btn = document.getElementById('rapidsRunBtn');
            const sim = document.getElementById('rapidsSimSection');
            const ws = document.getElementById('rapidsWritingSample');
            btn.style.display = 'none';
            sim.style.display = 'block';
            sim.innerHTML = `
                <div id="simInit" style="font-family: Montserrat, sans-serif; margin-bottom: 32px;">
                    <div id="simLine1" style="opacity: 0; transition: opacity 0.4s; margin-bottom: 16px;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #76B900;">Step 1: Initialize GPU</div>
                        <div style="font-size: 1rem; color: #ccc; margin-top: 4px;">Connecting to NVIDIA T4 GPU (16GB VRAM)</div>
                    </div>
                    <div id="simLine2" style="opacity: 0; transition: opacity 0.4s; margin-bottom: 16px;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #76B900;">Step 2: Load Data</div>
                        <div style="font-size: 1rem; color: #ccc; margin-top: 4px;">100 million rows of paid media data (campaign_id, spend, clicks, conversions, channel, geo)</div>
                    </div>
                    <div id="simLine3" style="opacity: 0; transition: opacity 0.4s; margin-bottom: 16px;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #76B900;">Step 3: Run GroupBy</div>
                        <div style="font-size: 1rem; color: #ccc; margin-top: 4px;">Aggregate total spend by campaign × channel × geography</div>
                    </div>
                    <div id="simExplain" style="opacity: 0; transition: opacity 0.4s; margin-bottom: 8px; padding: 16px 20px; background: rgba(118,185,0,0.08); border-radius: 8px; border-left: 3px solid #76B900;">
                        <div style="font-size: 1.1rem; color: #fff; line-height: 1.6; font-weight: 500;">Both engines run the <strong>exact same operation</strong> on the <strong>exact same data</strong>. The only difference: Pandas runs on CPU, cuDF runs on GPU. Watch the race below.</div>
                    </div>
                </div>
                <div style="margin-bottom: 24px;">
                    <div style="display: flex; align-items: center; margin-bottom: 16px;">
                        <div style="width: 160px; font-family: Montserrat, sans-serif; font-size: 1rem; font-weight: 700; color: #ff6b6b;">Pandas (CPU)</div>
                        <div style="flex: 1; background: #1a1a1a; border-radius: 8px; height: 48px; overflow: hidden; border: 1px solid #2a2a2a; position: relative;">
                            <div id="pandasBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #ff6b6b, #ee5a24); border-radius: 8px; transition: width 3.5s linear; display: flex; align-items: center; justify-content: flex-end; padding-right: 16px;">
                                <span id="pandasTime" style="font-family: Montserrat, sans-serif; font-size: 1rem; font-weight: 800; color: white; opacity: 0; transition: opacity 0.3s;">12.4 sec</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div style="width: 160px; font-family: Montserrat, sans-serif; font-size: 1rem; font-weight: 700; color: #76B900;">RAPIDS (GPU)</div>
                        <div style="flex: 1; background: #1a1a1a; border-radius: 8px; height: 48px; overflow: hidden; border: 1px solid #2a2a2a; position: relative;">
                            <div id="rapidsBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #76B900, #a8d700); border-radius: 8px; transition: width 0.3s ease-out; display: flex; align-items: center; justify-content: flex-end; padding-right: 16px;">
                                <span id="rapidsTime" style="font-family: Montserrat, sans-serif; font-size: 1rem; font-weight: 800; color: white; opacity: 0; transition: opacity 0.3s;">0.3 sec</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="speedupResult" style="text-align: center; margin-top: 32px; opacity: 0; transition: opacity 0.5s;">
                    <div style="font-family: Montserrat, sans-serif; font-size: 2.5rem; font-weight: 800; color: #76B900;">41x faster</div>
                    <div style="font-family: Montserrat, sans-serif; font-size: 1.1rem; color: #aaa; margin-top: 4px;">Same code. Same data. NVIDIA T4 GPU.</div>
                </div>
                <div style="text-align: center; margin-top: 16px; font-size: 0.8rem; color: #666; font-family: Montserrat, sans-serif;">
                    *Simulated results based on published RAPIDS benchmarks
                </div>
            `;
            // Animate init lines one by one
            setTimeout(function() { document.getElementById('simLine1').style.opacity = '1'; }, 100);
            setTimeout(function() { document.getElementById('simLine2').style.opacity = '1'; }, 800);
            setTimeout(function() { document.getElementById('simLine3').style.opacity = '1'; }, 1500);
            setTimeout(function() { document.getElementById('simExplain').style.opacity = '1'; }, 2200);
            // Start both bars racing at the same time (after text finishes)
            setTimeout(function() {
                document.getElementById('rapidsBar').style.width = '100%';
                document.getElementById('pandasBar').style.width = '100%';
            }, 3000);
            // Show RAPIDS time after it finishes (nearly instant)
            setTimeout(function() { document.getElementById('rapidsTime').style.opacity = '1'; }, 3500);
            // Show Pandas time after it finishes (crawls for 3.5s)
            setTimeout(function() { document.getElementById('pandasTime').style.opacity = '1'; }, 6600);
            // Show speedup result
            setTimeout(function() { document.getElementById('speedupResult').style.opacity = '1'; }, 7000);
            // Show writing sample
            setTimeout(function() {
                ws.style.opacity = '1';
                setTimeout(function() { ws.scrollIntoView({behavior: 'smooth'}); }, 200);
            }, 7800);
        }
    </script>

    <!-- RAPIDS vs Pandas Modal -->
    <div id="rapidsModal" class="fullscreen-modal">
        <button class="modal-close-btn" onclick="document.getElementById('rapidsModal').classList.remove('active'); document.body.style.overflow='auto'; document.getElementById('rapidsSimSection').style.display='none'; document.getElementById('rapidsWritingSample').style.opacity='0'; document.getElementById('rapidsRunBtn').style.display='inline-block';">&times;</button>
        <div style="max-width: 900px; margin: 0 auto; padding: 64px 40px;">
            <div style="text-align: center; margin-bottom: 64px;">
                <h1 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 24px; background: linear-gradient(135deg, #76B900, #a8d700); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Pandas vs RAPIDS cuDF</h1>
                <p style="font-size: 1.25rem; color: #e0e0e0; font-weight: 500;">GPU-Accelerated Data Processing Speed Test</p>
            </div>
            <div style="text-align: center;">
                <button id="rapidsRunBtn" onclick="runRapidsSimulation()" style="display: inline-block; padding: 18px 48px; background: #76B900; color: #0a0a0a; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 700; font-family: Montserrat, sans-serif; cursor: pointer; box-shadow: 0 10px 30px rgba(118,185,0,0.3); transition: all 0.3s;">RUN SPEED TEST</button>
            </div>
            <div id="rapidsSimSection" style="display: none; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 40px; margin: 40px 0; font-family: 'Courier New', monospace; font-size: 0.95rem; line-height: 2; color: #a8d700;"></div>
            <div id="rapidsWritingSample" style="opacity: 0; transition: opacity 0.8s ease;">
                <div style="border: 2px solid rgba(118,185,0,0.4); border-radius: 16px; padding: 48px 40px; margin-top: 48px; position: relative; background: rgba(118,185,0,0.03);">
                    <div style="position: absolute; top: -16px; left: 50%; transform: translateX(-50%); background: #0a0a0a; padding: 0 20px;">
                        <span style="font-family: Montserrat, sans-serif; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.15em; color: #c8f04d;">Hypothetical Writing Sample</span>
                    </div>
                    <div style="text-align: center; margin-bottom: 32px;">
                        <p style="font-size: 0.95rem; color: #999; font-family: Montserrat, sans-serif;">Below is a hypothetical NVIDIA developer blog post I wrote to demonstrate how I would market RAPIDS cuDF to data engineering teams. This is the type of product-focused technical content this role produces.</p>
                    </div>
                <article style="font-size: 1.05rem; line-height: 1.85; color: #e0e0e0;">
                    <h2 style="font-size: 1.75rem; font-weight: 700; color: #76B900; margin-top: 48px; margin-bottom: 16px;">Your CPU Is the Bottleneck. The GPU Is the Fix.</h2>
                    <p style="margin-bottom: 16px;">If your team runs ETL jobs in Pandas, you are leaving massive performance on the table. A <code style="background: #1a1a1a; padding: 2px 6px; border-radius: 4px; color: #c8f04d; font-size: 0.95em;">groupby()</code> on 100M rows takes 12.4 seconds on CPU. On an NVIDIA GPU, it takes 0.3 seconds. That is a 41x speedup with zero code changes. Your dashboards could be real-time. Your pipelines could finish before the next one starts. The hardware already exists in every major cloud provider. You just need to use it.</p>
                    <p style="margin-bottom: 16px;">RAPIDS cuDF is NVIDIA's open-source GPU DataFrame library. It implements the Pandas API on top of NVIDIA CUDA cores, so your existing Python code works with a single import swap. No CUDA programming required. No new syntax. <strong style="color: white;">Same API. Same code. GPU speed.</strong></p>

                    <h2 style="font-size: 1.75rem; font-weight: 700; color: #76B900; margin-top: 48px; margin-bottom: 16px;">One Import Change. Massive Speedup.</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 24px 0;">
                        <div style="background: #1a1a1a; border-left: 4px solid #888; border-radius: 4px; padding: 20px; font-family: 'Courier New', monospace; font-size: 0.9rem; color: #e0e0e0;">
                            <div style="color: #999; font-size: 0.8rem; margin-bottom: 8px; font-family: Montserrat; font-weight: 600;">PANDAS (CPU)</div>
                            <span style="color: #c8f04d;">import</span> pandas <span style="color: #c8f04d;">as</span> pd<br>df = pd.read_csv(<span style="color: #f0c674;">'campaign_data.csv'</span>)<br>result = df.groupby(<span style="color: #f0c674;">'campaign_id'</span>).agg({<br>&nbsp;&nbsp;<span style="color: #f0c674;">'spend'</span>: <span style="color: #f0c674;">'sum'</span>,<br>&nbsp;&nbsp;<span style="color: #f0c674;">'conversions'</span>: <span style="color: #f0c674;">'sum'</span><br>})
                        </div>
                        <div style="background: #1a1a1a; border-left: 4px solid #76B900; border-radius: 4px; padding: 20px; font-family: 'Courier New', monospace; font-size: 0.9rem; color: #e0e0e0;">
                            <div style="color: #c8f04d; font-size: 0.8rem; margin-bottom: 8px; font-family: Montserrat; font-weight: 600;">RAPIDS cuDF (GPU)</div>
                            <span style="color: #c8f04d;">import</span> cudf<br>df = cudf.read_csv(<span style="color: #f0c674;">'campaign_data.csv'</span>)<br>result = df.groupby(<span style="color: #f0c674;">'campaign_id'</span>).agg({<br>&nbsp;&nbsp;<span style="color: #f0c674;">'spend'</span>: <span style="color: #f0c674;">'sum'</span>,<br>&nbsp;&nbsp;<span style="color: #f0c674;">'conversions'</span>: <span style="color: #f0c674;">'sum'</span><br>})
                        </div>
                    </div>
                    <p style="margin-bottom: 16px; color: #bbb;">The code is identical. cuDF implements the full Pandas API surface, so your existing workflows, Jupyter notebooks, and scikit-learn preprocessing pipelines run on GPU without refactoring. You do not need to write any CUDA kernels or learn a new framework.</p>

                    <h2 style="font-size: 1.75rem; font-weight: 700; color: #76B900; margin-top: 48px; margin-bottom: 16px;">Benchmarks: 100M Rows of Paid Media Data</h2>
                    <p style="margin-bottom: 16px;">We benchmarked five core DataFrame operations on a 100-million-row ad performance dataset (the kind of table you would process for campaign reporting). Environment: Pandas 2.1 on a 4-core CPU vs. cuDF 24.02 on a single NVIDIA T4 GPU.</p>
                    <table style="width: 100%; border-collapse: collapse; margin: 24px 0; background: #1a1a1a; border-radius: 8px; overflow: hidden; border: 1px solid #2a2a2a;">
                        <thead><tr style="background: rgba(118,185,0,0.15);">
                            <th style="padding: 16px; text-align: left; color: #c8f04d; font-weight: 700;">Operation</th>
                            <th style="padding: 16px; text-align: left; color: #bbb;">Pandas (CPU)</th>
                            <th style="padding: 16px; text-align: left; color: #c8f04d;">cuDF (GPU)</th>
                            <th style="padding: 16px; text-align: left; color: #c8f04d; font-weight: 700;">Speedup</th>
                        </tr></thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #2a2a2a;"><td style="padding: 16px;"><strong style="color: white;">Read CSV</strong></td><td style="padding: 16px; color: #bbb;">8.2s</td><td style="padding: 16px; color: #c8f04d;">0.4s</td><td style="padding: 16px; color: #c8f04d; font-weight: 700;">20x</td></tr>
                            <tr style="border-bottom: 1px solid #2a2a2a;"><td style="padding: 16px;"><strong style="color: white;">GroupBy Aggregation</strong></td><td style="padding: 16px; color: #bbb;">12.4s</td><td style="padding: 16px; color: #c8f04d;">0.3s</td><td style="padding: 16px; color: #c8f04d; font-weight: 700;">41x</td></tr>
                            <tr style="border-bottom: 1px solid #2a2a2a;"><td style="padding: 16px;"><strong style="color: white;">Merge / Join</strong></td><td style="padding: 16px; color: #bbb;">15.1s</td><td style="padding: 16px; color: #c8f04d;">0.6s</td><td style="padding: 16px; color: #c8f04d; font-weight: 700;">25x</td></tr>
                            <tr style="border-bottom: 1px solid #2a2a2a;"><td style="padding: 16px;"><strong style="color: white;">Sort Values</strong></td><td style="padding: 16px; color: #bbb;">6.8s</td><td style="padding: 16px; color: #c8f04d;">0.2s</td><td style="padding: 16px; color: #c8f04d; font-weight: 700;">34x</td></tr>
                            <tr><td style="padding: 16px;"><strong style="color: white;">Boolean Filter</strong></td><td style="padding: 16px; color: #bbb;">3.2s</td><td style="padding: 16px; color: #c8f04d;">0.1s</td><td style="padding: 16px; color: #c8f04d; font-weight: 700;">32x</td></tr>
                        </tbody>
                    </table>
                    <div style="background: rgba(118,185,0,0.1); border-left: 4px solid #76B900; padding: 24px; margin: 24px 0; border-radius: 4px;">
                        <strong style="color: #c8f04d; font-size: 1.1rem;">41x faster groupby.</strong> <span style="color: #e0e0e0;">What took 12.4 seconds on CPU completes in 300ms on GPU. For ETL pipelines running hourly, this compounds into hours saved per day. It is the difference between real-time dashboards and stale data.</span>
                    </div>

                    <h2 style="font-size: 1.75rem; font-weight: 700; color: #76B900; margin-top: 48px; margin-bottom: 16px;">Drop Into Any Stack. Accelerate Immediately.</h2>
                    <p style="margin-bottom: 16px;">cuDF is not a new architecture. It is a drop-in acceleration layer for the Python data stack your team already uses. A typical pipeline queries a data warehouse (BigQuery, Redshift, Snowflake), transforms in Python, then feeds results into ML models or BI dashboards. cuDF accelerates that Python transformation step on NVIDIA GPUs, turning minutes of processing into seconds without rewriting a single pipeline.</p>
                    <p style="margin-bottom: 16px;">Because cuDF is built on NVIDIA CUDA, it leverages GPU parallelism across every operation: reads, joins, aggregations, sorts, and filters. The performance gap between CPU and GPU widens as data volume increases. At 100M+ rows, there is no comparison.</p>
                    <p style="margin-bottom: 16px;">cuDF also integrates with the broader RAPIDS ecosystem. <strong style="color: white;">cuML</strong> provides GPU-accelerated machine learning (random forests, XGBoost, k-means). <strong style="color: white;">cuGraph</strong> handles graph analytics on GPU. <strong style="color: white;">Dask-cuDF</strong> scales DataFrames across multi-GPU clusters for terabyte-scale workloads. Every layer of the pipeline, from ETL to model training, benefits from GPU acceleration.</p>

                    <h2 style="font-size: 1.75rem; font-weight: 700; color: #76B900; margin-top: 48px; margin-bottom: 16px;">The GPU Advantage Compounds</h2>
                    <p style="margin-bottom: 16px;">A single ETL job running 41x faster is notable on its own. But the real value compounds at scale. Hourly pipelines finish in real-time. Feature engineering no longer bottlenecks model training. Dashboards refresh in seconds instead of minutes. Every downstream process accelerates because the data layer got faster.</p>
                    <p style="margin-bottom: 16px;">NVIDIA GPUs are already deployed across AWS, GCP, and Azure. They are available free on Google Colab. There is no hardware barrier. The only thing between your team and 10-50x faster data processing is <strong style="color: white;">one import change</strong>.</p>
                </article>
                </div>
            </div>
        </div>
    </div>
    <!-- Assisted Conversions Modal -->
    <!-- Assisted Conversions Modal -->
    <div id="conversionsModal" class="fullscreen-modal">
        <button class="modal-close-btn" onclick="document.getElementById('conversionsModal').classList.remove('active'); document.body.style.overflow='auto';">&times;</button>
        <div style="max-width: 1200px; margin: 0 auto; padding: 48px 40px;">
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 40px;">
                <div style="display: inline-flex; align-items: center; gap: 12px; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 8px 16px; margin-bottom: 20px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#60A5FA" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                    <span style="font-family: 'Courier New', monospace; font-size: 0.9rem; color: #60A5FA;">README.md</span>
                </div>
                <h1 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 12px; background: linear-gradient(135deg, #60A5FA, #93C5FD); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; color: transparent;">Reconstructing Conversion Paths in SQL</h1>
                <p style="font-size: 1rem; color: #888; max-width: 700px; margin: 0 auto;">Post-View + Post-Click Lookbacks. Sanitized from documentation from my previous analytics role. All client names, credentials, and proprietary details removed.</p>
            </div>

            <!-- SQL + Context: Side-by-side layout -->
            <div id="conversionsReadme" style="display: grid; grid-template-columns: 1fr 420px; gap: 24px; align-items: start;">

                <!-- LEFT: Verbatim SQL query -->
                <div id="readmeScroller" style="background: #0d1117; border: 1px solid #30363d; border-radius: 8px; overflow: hidden;">
                    <!-- File tab bar -->
                    <div style="background: #161b22; border-bottom: 1px solid #30363d; padding: 8px 16px; display: flex; align-items: center; gap: 8px;">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#60A5FA" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                        <span style="font-family: ui-monospace, SFMono-Regular, monospace; font-size: 0.8rem; color: #e6edf3;">conversion_paths.sql</span>
                        <span style="font-size: 0.7rem; color: #484f58; margin-left: auto;">sanitized</span>
                    </div>
                    <pre style="margin: 0; padding: 24px; overflow-x: auto; font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace; font-size: 0.82rem; line-height: 1.7; color: #e6edf3; tab-size: 2;"><code><span class="readme-section" data-annotation="params" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;"><span style="color: #8b949e;">-- ============================================</span>
<span style="color: #8b949e;">-- RECONSTRUCTING CONVERSION PATHS IN SQL</span>
<span style="color: #8b949e;">-- Post-View + Post-Click Lookbacks</span>
<span style="color: #8b949e;">-- ============================================</span>
<span style="color: #8b949e;">-- Sanitized from a previous analytics role.</span>
<span style="color: #8b949e;">-- All client names and credentials removed.</span>

<span style="color: #ff7b72;">DECLARE</span> start_date <span style="color: #ff7b72;">DATE DEFAULT</span> <span style="color: #a5d6ff;">'2024-01-01'</span>;
<span style="color: #ff7b72;">DECLARE</span> end_date <span style="color: #ff7b72;">DATE DEFAULT</span> <span style="color: #a5d6ff;">'2024-03-31'</span>;
<span style="color: #ff7b72;">DECLARE</span> click_look <span style="color: #ff7b72;">INT64 DEFAULT</span> <span style="color: #79c0ff;">30</span>;
<span style="color: #ff7b72;">DECLARE</span> imp_look <span style="color: #ff7b72;">INT64 DEFAULT</span> <span style="color: #79c0ff;">7</span>;
<span style="color: #ff7b72;">DECLARE</span> campaign_filter <span style="color: #ff7b72;">STRING DEFAULT</span> <span style="color: #a5d6ff;">r'(?i)(brand|prospecting|retargeting)'</span>;</span>
<span class="readme-section" data-annotation="step1" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #ff7b72;">WITH</span> <span style="color: #d2a8ff;">filtered_conversions</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    c.user_id,
    c.conversion_id,
    c.activity_id,
    c.activity <span style="color: #ff7b72;">AS</span> activity_name,
    c.event_time <span style="color: #ff7b72;">AS</span> conversion_time,
    <span style="color: #ff7b72;">DATE</span>(c.event_time) <span style="color: #ff7b72;">AS</span> conversion_date
  <span style="color: #ff7b72;">FROM</span> <span style="color: #79c0ff;">`project.dataset.conversions`</span> c
  <span style="color: #ff7b72;">WHERE</span> <span style="color: #ff7b72;">DATE</span>(c.event_time) <span style="color: #ff7b72;">BETWEEN</span> start_date <span style="color: #ff7b72;">AND</span> end_date
    <span style="color: #ff7b72;">AND</span> c.advertiser_id = <span style="color: #a5d6ff;">'[REDACTED]'</span>
    <span style="color: #ff7b72;">AND</span> <span style="color: #ff7b72;">REGEXP_CONTAINS</span>(c.campaign, campaign_filter)
),</span>
<span class="readme-section" data-annotation="step2" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #d2a8ff;">conversion_anchors</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    fc.*,
    <span style="color: #ff7b72;">CONCAT</span>(fc.user_id, <span style="color: #a5d6ff;">'-'</span>, fc.conversion_id) <span style="color: #ff7b72;">AS</span> pseudo_id,
    <span style="color: #ff7b72;">COALESCE</span>(i.user_id, cl.user_id) <span style="color: #ff7b72;">AS</span> matched_user_id
  <span style="color: #ff7b72;">FROM</span> filtered_conversions fc
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.impressions`</span> i
    <span style="color: #ff7b72;">ON</span> fc.user_id = i.user_id
    <span style="color: #ff7b72;">AND</span> i.event_time &lt; fc.conversion_time
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.clicks`</span> cl
    <span style="color: #ff7b72;">ON</span> fc.user_id = cl.user_id
    <span style="color: #ff7b72;">AND</span> cl.event_time &lt; fc.conversion_time
  <span style="color: #ff7b72;">GROUP BY ALL</span>
),</span>
<span class="readme-section" data-annotation="step3" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #d2a8ff;">prior_impressions</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    ca.pseudo_id,
    ca.conversion_time,
    i.event_time <span style="color: #ff7b72;">AS</span> interaction_time,
    <span style="color: #a5d6ff;">'impression'</span> <span style="color: #ff7b72;">AS</span> interaction_type,
    i.campaign_id, i.site_id, i.placement_id, i.creative_id
  <span style="color: #ff7b72;">FROM</span> conversion_anchors ca
  <span style="color: #ff7b72;">JOIN</span> <span style="color: #79c0ff;">`project.dataset.impressions`</span> i
    <span style="color: #ff7b72;">ON</span> ca.matched_user_id = i.user_id
    <span style="color: #ff7b72;">AND</span> i.event_time &lt; ca.conversion_time
    <span style="color: #ff7b72;">AND</span> i.event_time &gt;= <span style="color: #ff7b72;">TIMESTAMP_SUB</span>(ca.conversion_time,
        <span style="color: #ff7b72;">INTERVAL</span> imp_look <span style="color: #ff7b72;">DAY</span>)
),

<span style="color: #d2a8ff;">prior_clicks</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    ca.pseudo_id,
    ca.conversion_time,
    cl.event_time <span style="color: #ff7b72;">AS</span> interaction_time,
    <span style="color: #a5d6ff;">'click'</span> <span style="color: #ff7b72;">AS</span> interaction_type,
    cl.campaign_id, cl.site_id, cl.placement_id, cl.creative_id
  <span style="color: #ff7b72;">FROM</span> conversion_anchors ca
  <span style="color: #ff7b72;">JOIN</span> <span style="color: #79c0ff;">`project.dataset.clicks`</span> cl
    <span style="color: #ff7b72;">ON</span> ca.matched_user_id = cl.user_id
    <span style="color: #ff7b72;">AND</span> cl.event_time &lt; ca.conversion_time
    <span style="color: #ff7b72;">AND</span> cl.event_time &gt;= <span style="color: #ff7b72;">TIMESTAMP_SUB</span>(ca.conversion_time,
        <span style="color: #ff7b72;">INTERVAL</span> click_look <span style="color: #ff7b72;">DAY</span>)
),

<span style="color: #d2a8ff;">all_interactions</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span> * <span style="color: #ff7b72;">FROM</span> prior_impressions
  <span style="color: #ff7b72;">UNION ALL</span>
  <span style="color: #ff7b72;">SELECT</span> * <span style="color: #ff7b72;">FROM</span> prior_clicks
),</span>
<span class="readme-section" data-annotation="step4" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #d2a8ff;">deduped_ranked</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    pseudo_id,
    conversion_time,
    interaction_time,
    interaction_type,
    campaign_id, site_id, placement_id, creative_id,
    <span style="color: #ff7b72;">ROW_NUMBER</span>() <span style="color: #ff7b72;">OVER</span> (
      <span style="color: #ff7b72;">PARTITION BY</span> pseudo_id
      <span style="color: #ff7b72;">ORDER BY</span> interaction_time <span style="color: #ff7b72;">DESC</span>
    ) <span style="color: #ff7b72;">AS</span> interaction_rank
  <span style="color: #ff7b72;">FROM</span> (
    <span style="color: #ff7b72;">SELECT DISTINCT</span> *
    <span style="color: #ff7b72;">FROM</span> all_interactions
  )
),</span>
<span class="readme-section" data-annotation="step5" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #d2a8ff;">path_metrics</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    dr.*,
    <span style="color: #ff7b72;">COUNT</span>(*) <span style="color: #ff7b72;">OVER</span> (<span style="color: #ff7b72;">PARTITION BY</span> pseudo_id) <span style="color: #ff7b72;">AS</span> path_length,
    <span style="color: #ff7b72;">MIN</span>(interaction_time) <span style="color: #ff7b72;">OVER</span> (<span style="color: #ff7b72;">PARTITION BY</span> pseudo_id)
      <span style="color: #ff7b72;">AS</span> first_touch_time,
    <span style="color: #ff7b72;">MAX</span>(interaction_time) <span style="color: #ff7b72;">OVER</span> (<span style="color: #ff7b72;">PARTITION BY</span> pseudo_id)
      <span style="color: #ff7b72;">AS</span> last_touch_time,
    <span style="color: #ff7b72;">CASE</span>
      <span style="color: #ff7b72;">WHEN</span> interaction_rank = <span style="color: #79c0ff;">1</span> <span style="color: #ff7b72;">THEN</span> <span style="color: #a5d6ff;">'Last'</span>
      <span style="color: #ff7b72;">WHEN</span> interaction_rank = <span style="color: #ff7b72;">COUNT</span>(*) <span style="color: #ff7b72;">OVER</span> (
        <span style="color: #ff7b72;">PARTITION BY</span> pseudo_id) <span style="color: #ff7b72;">THEN</span> <span style="color: #a5d6ff;">'First'</span>
      <span style="color: #ff7b72;">ELSE</span> <span style="color: #a5d6ff;">'Middle'</span>
    <span style="color: #ff7b72;">END AS</span> touch_position
  <span style="color: #ff7b72;">FROM</span> deduped_ranked dr
),</span>
<span class="readme-section" data-annotation="step6" style="display: block; padding: 8px 0; border-left: 3px solid transparent; padding-left: 12px; margin-left: -12px; transition: border-color 0.4s, background 0.4s;">
<span style="color: #d2a8ff;">final_output</span> <span style="color: #ff7b72;">AS</span> (
  <span style="color: #ff7b72;">SELECT</span>
    pm.pseudo_id,
    fc.activity_name,
    fc.activity_id,
    fc.conversion_date,
    <span style="color: #ff7b72;">LEAST</span>(pm.path_length, <span style="color: #79c0ff;">30</span>) <span style="color: #ff7b72;">AS</span> path_length,
    <span style="color: #ff7b72;">DATE_DIFF</span>(fc.conversion_date,
      <span style="color: #ff7b72;">DATE</span>(pm.first_touch_time), <span style="color: #ff7b72;">DAY</span>)
      <span style="color: #ff7b72;">AS</span> days_since_first_interaction,
    <span style="color: #ff7b72;">DATE_DIFF</span>(fc.conversion_date,
      <span style="color: #ff7b72;">DATE</span>(pm.last_touch_time), <span style="color: #ff7b72;">DAY</span>)
      <span style="color: #ff7b72;">AS</span> days_since_last_interaction,
    <span style="color: #ff7b72;">DATE</span>(pm.interaction_time) <span style="color: #ff7b72;">AS</span> interaction_date,
    pm.interaction_rank <span style="color: #ff7b72;">AS</span> interaction_number,
    pm.interaction_type,
    <span style="color: #ff7b72;">COALESCE</span>(camp.campaign_name, <span style="color: #a5d6ff;">'N/A'</span>) <span style="color: #ff7b72;">AS</span> campaign,
    <span style="color: #ff7b72;">COALESCE</span>(s.site_name, <span style="color: #a5d6ff;">'N/A'</span>) <span style="color: #ff7b72;">AS</span> site,
    <span style="color: #ff7b72;">COALESCE</span>(p.placement_name, <span style="color: #a5d6ff;">'N/A'</span>) <span style="color: #ff7b72;">AS</span> placement,
    <span style="color: #ff7b72;">COALESCE</span>(cr.creative_name, <span style="color: #a5d6ff;">'N/A'</span>) <span style="color: #ff7b72;">AS</span> creative,
    pm.touch_position
  <span style="color: #ff7b72;">FROM</span> path_metrics pm
  <span style="color: #ff7b72;">JOIN</span> filtered_conversions fc
    <span style="color: #ff7b72;">ON</span> pm.pseudo_id = <span style="color: #ff7b72;">CONCAT</span>(fc.user_id, <span style="color: #a5d6ff;">'-'</span>, fc.conversion_id)
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.campaigns`</span> camp
    <span style="color: #ff7b72;">ON</span> pm.campaign_id = camp.campaign_id
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.sites`</span> s
    <span style="color: #ff7b72;">ON</span> pm.site_id = s.site_id
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.placements`</span> p
    <span style="color: #ff7b72;">ON</span> pm.placement_id = p.placement_id
  <span style="color: #ff7b72;">LEFT JOIN</span> <span style="color: #79c0ff;">`project.dataset.creatives`</span> cr
    <span style="color: #ff7b72;">ON</span> pm.creative_id = cr.creative_id
)

<span style="color: #ff7b72;">SELECT</span> * <span style="color: #ff7b72;">FROM</span> final_output
<span style="color: #ff7b72;">ORDER BY</span> pseudo_id, interaction_number;</span></code></pre>
                </div>

                <!-- RIGHT: Scroll-linked context box with arrow indicator -->
                <div style="position: sticky; top: 50%; transform: translateY(-50%); align-self: start;">
                    <div style="background: #161b22; border: 1px solid #30363d; border-radius: 12px; padding: 32px 36px; box-shadow: 0 8px 32px rgba(0,0,0,0.4);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 22px;">
                            <div style="font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.12em; color: #60A5FA;">Context</div>
                            <div id="guideSectionLabel" style="font-size: 0.85rem; color: #484f58; font-weight: 600;">1 / 7</div>
                        </div>

                        <div id="guideContent">
                            <div id="guideTitle" style="font-size: 1.5rem; font-weight: 700; color: #e6edf3; margin-bottom: 16px; line-height: 1.3;">Parameters</div>
                            <div id="guideDesc" style="font-size: 1.15rem; color: #8b949e; line-height: 1.7;">The query starts by declaring configurable inputs: date range, lookback windows for clicks (30 days) and impressions (7 days), and a regex filter for campaign types. An analyst can change these without touching the SQL logic.</div>
                        </div>

                        <div id="guideExample" style="margin-top: 18px; padding: 14px 18px; background: rgba(96,165,250,0.08); border-radius: 8px; border-left: 3px solid #60A5FA; display: block;">
                            <div style="font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #60A5FA; margin-bottom: 8px;">Example</div>
                            <div id="guideExampleText" style="font-size: 1.05rem; color: #8b949e; line-height: 1.6;">If the team wants to analyze Q1 retargeting only, they change <code style="background: rgba(110,118,129,0.3); padding: 2px 6px; border-radius: 4px; color: #e6edf3; font-size: 0.9rem;">campaign_filter</code> to <code style="background: rgba(110,118,129,0.3); padding: 2px 6px; border-radius: 4px; color: #e6edf3; font-size: 0.9rem;">r'retargeting'</code> and run.</div>
                        </div>

                        <div style="margin-top: 20px; padding-top: 12px; border-top: 1px solid #21262d;">
                            <div id="guideProgress" style="height: 3px; background: #21262d; border-radius: 2px; overflow: hidden;">
                                <div id="guideProgressBar" style="width: 14%; height: 100%; background: #60A5FA; border-radius: 2px; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Email section removed -->
        </div>
    </div>

    <script>
        // Context guide data for SQL sections
        var guideData = {
            params: {
                title: 'Parameters',
                desc: 'The query starts by declaring configurable inputs: date range, lookback windows for clicks (30 days) and impressions (7 days), and a regex filter for campaign types. An analyst can change these without touching the SQL logic.',
                example: 'If the team wants to analyze Q1 retargeting only, they change <code style="background:rgba(110,118,129,0.3);padding:2px 6px;border-radius:4px;color:#e6edf3;font-size:0.85rem;">campaign_filter</code> to <code style="background:rgba(110,118,129,0.3);padding:2px 6px;border-radius:4px;color:#e6edf3;font-size:0.85rem;">r\'retargeting\'</code> and run.',
                index: 1
            },
            step1: {
                title: 'Step 1: Filter Conversions',
                desc: 'Pulls only conversions that fall within the date range and match the advertiser and campaign filters. This narrows the dataset before any expensive joins.',
                example: 'If there are 10M conversion rows but only 200K match the date range and campaign regex, this step cuts 98% of the data upfront.',
                index: 2
            },
            step2: {
                title: 'Step 2: Anchor Each Conversion',
                desc: 'Creates a unique ID for each conversion event by combining user_id and conversion_id. This becomes the key that links every upstream touchpoint back to a specific conversion.',
                example: 'User 482 with conversion 91 becomes <code style="background:rgba(110,118,129,0.3);padding:2px 6px;border-radius:4px;color:#e6edf3;font-size:0.85rem;">482-91</code>, so their ad interactions can be traced to that exact purchase.',
                index: 3
            },
            step3: {
                title: 'Step 3: Collect Prior Interactions',
                desc: 'For each conversion, looks back in time to find all impressions (within 7 days) and clicks (within 30 days) that the same user saw before converting. Unions them into a single timeline.',
                example: 'A user converts on March 15. The query finds their click on March 2 (13 days prior) and impressions on March 10 and March 14, building a 3-touchpoint path.',
                index: 4
            },
            step4: {
                title: 'Step 4: Deduplicate and Rank',
                desc: 'Removes duplicate interactions (same user, same ad, same day) and assigns a rank to each remaining touchpoint by recency. The most recent interaction gets rank 1.',
                example: 'If a user saw the same banner ad 5 times on March 10, it counts as one interaction. Their 3 unique touchpoints get ranked 1 (newest) to 3 (oldest).',
                index: 5
            },
            step5: {
                title: 'Step 5: Path Metrics',
                desc: 'Computes the full path length, identifies first and last touch timestamps, and labels each touchpoint as First, Last, or Middle based on its position in the conversion journey.',
                example: 'A path with 4 touchpoints gets: path_length = 4, the earliest interaction tagged "First," the latest tagged "Last," and the two in between tagged "Middle."',
                index: 6
            },
            step6: {
                title: 'Step 6: Final Output',
                desc: 'Joins in human-readable names for campaigns, sites, placements, and creatives from lookup tables. Fills any gaps with "N/A" defaults. The final SELECT produces the analysis-ready dataset.',
                example: 'Instead of campaign_id 7294, the output shows "Q1_Retargeting_Display." Instead of a missing creative, it shows "N/A" so downstream dashboards do not break.',
                index: 7
            }
        };
        var totalSections = 7;

        function updateGuideHighlight() {
            var sections = document.querySelectorAll('.readme-section');
            var currentSection = 'params';
            sections.forEach(function(sec) {
                var rect = sec.getBoundingClientRect();
                if (rect.top < window.innerHeight * 0.45) {
                    currentSection = sec.getAttribute('data-annotation');
                }
            });
            var data = guideData[currentSection];
            if (!data) return;
            var titleEl = document.getElementById('guideTitle');
            var descEl = document.getElementById('guideDesc');
            var barEl = document.getElementById('guideProgressBar');
            var labelEl = document.getElementById('guideSectionLabel');
            var exampleEl = document.getElementById('guideExampleText');
            if (titleEl) titleEl.textContent = data.title;
            if (descEl) descEl.textContent = data.desc;
            if (exampleEl) exampleEl.innerHTML = data.example;
            if (barEl) barEl.style.width = ((data.index / totalSections) * 100) + '%';
            if (labelEl) labelEl.textContent = data.index + ' / ' + totalSections;

            // Highlight active SQL section with border-left
            sections.forEach(function(sec) {
                var ann = sec.getAttribute('data-annotation');
                if (ann === currentSection) {
                    sec.style.borderLeftColor = '#60A5FA';
                    sec.style.background = 'rgba(96,165,250,0.06)';
                } else {
                    sec.style.borderLeftColor = 'transparent';
                    sec.style.background = 'transparent';
                }
            });
        }

        // Initialize scroll listener when modal opens
        var conversionsModalEl = document.getElementById('conversionsModal');
        var convScrollInit = false;
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(m) {
                if (m.target.classList.contains('active') && !convScrollInit) {
                    convScrollInit = true;
                    conversionsModalEl.addEventListener('scroll', updateGuideHighlight);
                    updateGuideHighlight();
                }
            });
        });
        observer.observe(conversionsModalEl, { attributes: true, attributeFilter: ['class'] });
    </script>
</body>
</html>
